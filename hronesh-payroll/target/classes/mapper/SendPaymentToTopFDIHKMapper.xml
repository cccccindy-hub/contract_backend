<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.nnroad.payroll.mapper.SendPaymentToTopFDIHKMapper">

    <resultMap type="PsBasicInfo" id="PsBasicInfoResult">
        <result property="id"    column="id"    />
        <result property="duration"    column="duration"    />
        <result property="erName"    column="er_name"    />
        <result property="idNo"    column="id_no"    />
        <result property="name"    column="name"    />
        <result property="enName"    column="en_name"    />
        <result property="sex"    column="sex"    />
        <result property="clientType"    column="client_type"    />
        <result property="workAddress"    column="work_address"    />
        <result property="socialBenefitsAddress"    column="social_benefits_address"    />
        <result property="housingFundAddress"    column="housing_fund_address"    />
        <result property="employmentNature"    column="employment_nature"    />
        <result property="serviceStarttime"    column="service_starttime"    />
        <result property="contractAddress"    column="contract_address"    />
        <result property="contractStarttime"    column="contract_starttime"    />
        <result property="contractEndtime"    column="contract_endtime"    />
        <result property="leaveDate"    column="leave_date"    />
        <result property="preAfterTax"    column="pre_after_tax"    />
        <result property="basicSalary"    column="basic_salary"    />
        <result property="dailySalary"    column="daily_salary"    />
        <result property="floatingSalary"    column="floating_salary"    />
        <result property="transportAllowance"    column="transport_allowance"    />
        <result property="communicationAllowance"    column="communication_allowance"    />
        <result property="mealAllowance"    column="meal_allowance"    />
        <result property="otherFixedAllowance"    column="other_fixed_allowance"    />
        <result property="msaBase"    column="msa_base"    />
        <result property="nsaBase"    column="nsa_base"    />
        <result property="hwaBase"    column="hwa_base"    />
        <result property="hwhfBase"    column="hwhf_base"    />
        <result property="phfBase"    column="phf_base"    />
        <result property="onlyChildBirthday"    column="only_child_birthday"    />
        <result property="ocaBase"    column="oca_base"    />
        <result property="fixedSubsidy"    column="fixed_subsidy"    />
        <result property="fixedDeduction"    column="fixed_deduction"    />
        <result property="pensionBase"    column="pension_base"    />
        <result property="medicalBase"    column="medical_base"    />
        <result property="unemploymentBase"    column="unemployment_base"    />
        <result property="maternityBase"    column="maternity_base"    />
        <result property="workRelatedInjuryBase"    column="work_related_injury_base"    />
        <result property="disabilityBase"    column="disability_base"    />
        <result property="housingFundBase"    column="housing_fund_base"    />
        <result property="shfBase"    column="shf_base"    />
        <result property="personalPension"    column="personal_pension"    />
        <result property="personalMedical"    column="personal_medical"    />
        <result property="personalUnemployment"    column="personal_unemployment"    />
        <result property="personalHousingFund"    column="personal_housing_fund"    />
        <result property="personalShfTe"    column="personal_shf_te"    />
        <result property="personalShfNte"    column="personal_shf_nte"    />
        <result property="personalMedicalFixedNumber"    column="personal_medical_fixed_number"    />
        <result property="companyPension"    column="company_pension"    />
        <result property="companyMedical"    column="company_medical"    />
        <result property="companyUnemployment"    column="company_unemployment"    />
        <result property="companyMaternity"    column="company_maternity"    />
        <result property="companyWorkRelatedInjury"    column="company_work_related_injury"    />
        <result property="companyDisability"    column="company_disability"    />
        <result property="companyHousingFund"    column="company_housing_fund"    />
        <result property="companyShf"    column="company_shf"    />
        <result property="companyMedicalFixedNumber"    column="company_medical_fixed_number"    />
        <result property="companyWriFixedNumber"    column="company_wri_fixed_number"    />
        <result property="companyDisabilityFixedNumber"    column="company_disability_fixed_number"    />
        <result property="annuity"    column="annuity"    />
        <result property="unionFee"    column="union_fee"    />
        <result property="taxNotIssued"    column="tax_not_issued"    />
        <result property="companyTax"    column="company_tax"    />
        <result property="fsAllowance"    column="fs_allowance"    />
        <result property="afterTaxDeduction"    column="after_tax_deduction"    />
        <result property="taxFreeIncome"    column="tax_free_income"    />
        <result property="certificateType"    column="certificate_type"    />
        <result property="certificateNumber"    column="certificate_number"    />
        <result property="birthday"    column="birthday"    />
        <result property="housingFundAccount"    column="housing_fund_account"    />
        <result property="bankAccounName"    column="bank_accoun_name"    />
        <result property="bankAccount"    column="bank_account"    />
        <result property="bank"    column="bank"    />
        <result property="department"    column="department"    />
        <result property="post"    column="post"    />
        <result property="nationality"    column="nationality"    />
        <result property="nationalityCode"    column="nationality_code"    />
        <result property="payroll"    column="payroll"    />
        <result property="telephone"    column="telephone"    />
        <result property="mailbox"    column="mailbox"    />
        <result property="billAddress"    column="bill_address"    />
        <result property="postcode"    column="postcode"    />
        <result property="residenceType"    column="residence_type"    />
        <result property="residenceAddress"    column="residence_address"    />
        <result property="commercialInsuranceCost"    column="commercial_insurance_cost"    />
        <result property="commercialInsuranceLevel"    column="commercial_insurance_level"    />
        <result property="spouseChildrenInsurance"    column="spouse_children_insurance"    />
        <result property="greenAllowance"    column="green_allowance"    />
        <result property="physicalExamination"    column="physical_examination"    />
        <result property="fileManagementFee"    column="file_management_fee"    />
        <result property="annualBonusInfo"    column="annual_bonus_info"    />
        <result property="thirteenSalaryMonth"    column="thirteen_salary_month"    />
        <result property="remarks"    column="remarks"    />
        <result property="taxPaymentPlace"    column="tax_payment_place"    />
        <result property="taxFreeItem"    column="tax_free_item"    />
        <result property="accumulatedChildEducation"    column="accumulated_child_education"    />
        <result property="accumulatedContinuingEducation"    column="accumulated_continuing_education"    />
        <result property="accumulatedHli"    column="accumulated_hli"    />
        <result property="accumulatedHousingRent"    column="accumulated_housing_rent"    />
        <result property="accumulatedSfte"    column="accumulated_sfte"    />
        <result property="commercialHealthInsurance"    column="commercial_health_insurance"    />
        <result property="tdpInsurance"    column="tdp_insurance"    />
        <result property="otherTaxFreeDeductions"    column="other_tax_free_deductions"    />
        <result property="dailyAttendanceDays"    column="daily_attendance_days"    />
        <result property="monthlyAward"    column="monthly_award"    />
        <result property="quarterAward"    column="quarter_award"    />
        <result property="overtime150hours"    column="overtime_150hours"    />
        <result property="overtime200hours"    column="overtime_200hours"    />
        <result property="overtime300hours"    column="overtime_300hours"    />
        <result property="fullAttendanceDays"    column="full_attendance_days"    />
        <result property="ealDays"    column="eal_days"    />
        <result property="affairLeaveDays"    column="affair_leave_days"    />
        <result property="absentEeismDays"    column="absent_eeism_days"    />
        <result property="sickLeaveDays"    column="sick_leave_days"    />
        <result property="sickLeaveDeduction"    column="sick_leave_deduction"    />
        <result property="transportationFee"    column="transportation_fee"    />
        <result property="communicationFee"    column="communication_fee"    />
        <result property="middleShiftDay"    column="middle_shift_day"    />
        <result property="nightShiftDays"    column="night_shift_days"    />
        <result property="highTemperatureDays"    column="high_temperature_days"    />
        <result property="ohtFee"    column="oht_fee"    />
        <result property="hotWorkingDays"    column="hot_working_days"    />
        <result property="tahwDays"    column="tahw_days"    />
        <result property="reissue"    column="reissue"    />
        <result property="wageDeduction"    column="wage_deduction"    />
        <result property="pensionRepayment"    column="pension_repayment"    />
        <result property="medicalRepayment"    column="medical_repayment"    />
        <result property="unemploymentRepayment"    column="unemployment_repayment"    />
        <result property="housingFundPayment"    column="housing_fund_payment"    />
        <result property="taxFreeIncome2"    column="tax_free_income2"    />
        <result property="taxCalculation"    column="tax_calculation"    />
        <result property="companyTax2"    column="company_tax2"    />
        <result property="expense"    column="expense"    />
        <result property="expense25"    column="expense_25"    />
        <result property="afterTaxReissue"    column="after_tax_reissue"    />
        <result property="afterTaxDeduction2"    column="after_tax_deduction2"    />
        <result property="individualTaxAdjustment"    column="Individual_tax_adjustment"    />
        <result property="annualBonus"    column="annual_bonus"    />
        <result property="remarks2"    column="remarks2"    />
        <result property="csbRepayment"    column="csb_repayment"    />
        <result property="chfRepayment"    column="chf_repayment"    />
        <result property="cdRepayment"    column="cd_repayment"    />
        <result property="basicDeductionAdjustment"    column="basic_deduction_adjustment"    />
        <result property="payrollBelong"    column="payroll_belong"    />
        <result property="bankLocation"    column="bank_location"    />
        <result property="severance"    column="severance"    />
        <result property="birthdayGift"    column="birthday_gift"    />
        <result property="otherAllowance"    column="other_allowance"    />
        <result property="heatingFee"    column="heating_fee"    />
        <result property="paySBFlag"    column="pay_sb_flag"    />
        <result property="payHFFlag"    column="pay_hf_flag"    />
        <result property="payIITFlag"    column="pay_iit_flag"    />
        <result property="clientCode"    column="client_code"    />
        <result property="employeeNo"    column="employee_no"    />
        <result property="costCenter"    column="cost_center"    />
        <result property="actualPerformance"    column="actual_performance"    />
        <result property="performanceBonusBase"    column="performance_bonus_base"    />
        <result property="commission"    column="commission"    />
        <result property="otherBonus"    column="other_bonus"    />
        <result property="pretaxAdjustment"    column="pre_tax_adjustment"    />
        <result property="indemnity"    column="indemnity"    />
        <result property="indemnityAllowance"    column="indemnity_allowance"    />
        <result property="compensationCalculationYear"    column="compensation_calculation_year"    />
        <result property="shareIncentives"    column="share_incentives"    />
        <result property="travelAllowance"    column="travel_allowance"    />
        <result property="accumulatedChildCare"    column="accumulated_child_care"    />
        <result property="groupIds"    column="group_ids"    />
        <result property="createBy"   column="create_by"   />
        <result property="createTime" column="create_time" />
        <result property="updateBy"   column="update_by"   />
        <result property="updateTime" column="update_time" />
    </resultMap>

    <resultMap type="PsCalculationResult" id="PsCalculationResultResult">
        <result property="id"    column="id"    />
        <result property="duration"    column="duration"    />
        <result property="erName"    column="er_name"    />
        <result property="idNo"    column="id_no"    />
        <result property="certificateNumber"    column="certificate_number"    />
        <result property="socialBenefitsAddress"    column="social_benefits_address"    />
        <result property="name"    column="name"    />
        <result property="basicSalary"    column="basic_salary"    />
        <result property="floatingSalary"    column="floating_salary"    />
        <result property="monthlyAward"    column="monthly_award"    />
        <result property="quarterAward"    column="quarter_award"    />
        <result property="overtimeAward150"    column="overtime_award_150"    />
        <result property="overtimeAward200"    column="overtime_award_200"    />
        <result property="overtimeAward300"    column="overtime_award_300"    />
        <result property="ealaDeduction"    column="eala_deduction"    />
        <result property="alDeduction"    column="al_deduction"    />
        <result property="absenteeismDeduction"    column="absenteeism_deduction"    />
        <result property="slDeduction"    column="sl_deduction"    />
        <result property="transportationPayment"    column="transportation_payment"    />
        <result property="communicationPayment"    column="communication_payment"    />
        <result property="mealAllowance"    column="meal_allowance"    />
        <result property="birthdayGift"    column="birthday_gift"    />
        <result property="otherBenefits"    column="other_benefits"    />
        <result property="middleShiftPayment"    column="middle_shift_payment"    />
        <result property="nightShiftPayment"    column="night_shift_payment"    />
        <result property="highTemperaturePayment"    column="high_temperature_payment"    />
        <result property="hotWorkingPayment"    column="hot_working_payment"    />
        <result property="tahwPayment"    column="tahw_payment"    />
        <result property="reissue"    column="reissue"    />
        <result property="wageDeduction"    column="wage_deduction"    />
        <result property="pension"    column="pension"    />
        <result property="medical"    column="medical"    />
        <result property="unemployment"    column="unemployment"    />
        <result property="housingFund"    column="housing_fund"    />
        <result property="steHousingFund"    column="ste_housing_fund"    />
        <result property="socialBenefitsAdjustment"    column="social_benefits_adjustment"    />
        <result property="housingFundAdjustment"    column="housing_fund_adjustment"    />
        <result property="annuity"    column="annuity"    />
        <result property="unionFee"    column="union_fee"    />
        <result property="taxCalculation"    column="tax_calculation"    />
        <result property="preTaxIncome"    column="pre_tax_income"    />
        <result property="basicDeduction"    column="basic_deduction"    />
        <result property="accumulatedIpti"    column="accumulated_ipti"    />
        <result property="accumulatedIsiahf"    column="accumulated_isiahf"    />
        <result property="accumulatedBd"    column="accumulated_bd"    />
        <result property="accumulatedChildEducation"    column="accumulated_child_education"    />
        <result property="accumulatedContinuingEducation"    column="accumulated_continuing_education"    />
        <result property="accumulatedHli"    column="accumulated_hli"    />
        <result property="accumulatedHousingRent"    column="accumulated_housing_rent"    />
        <result property="accumulatedSfte"    column="accumulated_sfte"    />
        <result property="accumulatedOther"    column="accumulated_other"    />
        <result property="accumulatedTftd"    column="accumulated_tftd"    />
        <result property="accumulatedTotalCost"    column="accumulated_total_cost"    />
        <result property="accumulatedIl"    column="accumulated_il"    />
        <result property="individualLlt"    column="individual_llt"    />
        <result property="companyTax"    column="company_tax"    />
        <result property="companyTotalTax"    column="company_total_tax"    />
        <result property="accumulatedAti"    column="accumulated_ati"    />
        <result property="accumulatedBti"    column="accumulated_bti"    />
        <result property="theoreticalIncome"    column="theoretical_income"    />
        <result property="accumulatedLltCai"    column="accumulated_llt_cai"    />
        <result property="companyLlt"    column="company_llt"    />
        <result property="onlyChildAllowance"    column="only_child_allowance"    />
        <result property="snteHousingFund"    column="snte_housing_fund"    />
        <result property="expense"    column="expense"    />
        <result property="expense25"    column="expense_25"    />
        <result property="fsAllowance"    column="fs_allowance"    />
        <result property="afterTaxReissue"    column="after_tax_reissue"    />
        <result property="afterTaxDeduction"    column="after_tax_deduction"    />
        <result property="annualBonus"    column="annual_bonus"    />
        <result property="annualBonusLlt"    column="annual_bonus_llt"    />
        <result property="income"    column="income"    />
        <result property="cost"    column="cost"    />
        <result property="netIncome"    column="net_income"    />
        <result property="companyPension"    column="company_pension"    />
        <result property="companyMedical"    column="company_medical"    />
        <result property="companyUnemployment"    column="company_unemployment"    />
        <result property="companyMaternity"    column="company_maternity"    />
        <result property="companyWri"    column="company_wri"    />
        <result property="companyDisability"    column="company_disability"    />
        <result property="companyHousingFund"    column="company_housing_fund"    />
        <result property="companyShf"    column="company_shf"    />
        <result property="accumulatedPayrollTax"    column="accumulated_payroll_tax"    />
        <result property="employerLiability"    column="employer_liability"    />
        <result property="deposit"    column="deposit"    />
        <result property="serviceFee"    column="service_fee"    />
        <result property="valueAddedTax"    column="value_added_tax"    />
        <result property="otherBonus"    column="other_bonus"    />
        <result property="pretaxAdjustment"    column="pre_tax_adjustment"    />
        <result property="indemnity"    column="indemnity"    />
        <result property="indemnityTax"    column="indemnity_tax"    />
        <result property="shareIncentives"    column="share_incentives"    />
        <result property="shareIncentivesTax"    column="share_incentives_tax"    />
        <result property="serviceFeeTax"    column="service_fee_tax"    />
        <result property="travelAllowance"    column="travel_allowance"    />
        <result property="accumulatedChildCare"    column="accumulated_child_care"    />
        <result property="clientCode"    column="client_code"    />
        <result property="groupIds"    column="group_ids"    />
        <result property="createBy"   column="create_by"   />
        <result property="createTime" column="create_time" />
        <result property="updateBy"   column="update_by"   />
        <result property="updateTime" column="update_time" />
        <result property="entryDate"    column="entry_date"    />
    </resultMap>

    <resultMap type="PsPayroll" id="PsPayrollResult">
        <result property="id"    column="id"    />
        <result property="department"    column="department"    />
        <result property="duration"    column="duration"    />
        <result property="idNo"    column="id_no"    />
        <result property="name"    column="name"    />
        <result property="netIncome"    column="net_income"    />
        <result property="expense"    column="expense"    />
        <result property="foreignerAllowance"    column="foreigner_allowance"    />
        <result property="ipPension"    column="ip_pension"    />
        <result property="ipMedical"    column="ip_medical"    />
        <result property="ipUnemployment"    column="ip_unemployment"    />
        <result property="ipHousingFund"    column="ip_housing_fund"    />
        <result property="ipAnnuity"    column="ip_annuity"    />
        <result property="ipUnionFee"    column="ip_union_fee"    />
        <result property="IIT"    column="IIT"    />
        <result property="balanceCharge"    column="balance_charge"    />
        <result property="epPension"    column="ep_pension"    />
        <result property="epMedical"    column="ep_medical"    />
        <result property="epUnemployment"    column="ep_unemployment"    />
        <result property="maternity"    column="maternity"    />
        <result property="workRelatedInjury"    column="work_related_Injury"    />
        <result property="disability"    column="disability"    />
        <result property="epHousingFund"    column="ep_housing_fund"    />
        <result property="epAnnuity"    column="ep_annuity"    />
        <result property="epUnionFee"    column="ep_union_fee"    />
        <result property="epHeatingFee"    column="ep_heating_fee"    />
        <result property="commercialInsurance"    column="commercial_insurance"    />
        <result property="otherBenefits"    column="other_benefits"    />
        <result property="serviceFee"    column="service_fee"    />
        <result property="businessTax"    column="business_tax"    />
        <result property="deposit"    column="deposit"    />
        <result property="employerLiability"    column="employer_liability"    />
        <result property="officeSeat"    column="office_seat"    />
        <result property="others"    column="others"    />
        <result property="serviceFeeTax"    column="service_fee_tax"    />
        <result property="valueAddedTax"    column="value_added_tax"    />
        <result property="totalCost"    column="total_cost"    />
        <result property="taxFreeItem"    column="tax_free_item"    />
        <result property="remarks"    column="remarks"    />
        <result property="groupIds"    column="group_ids"    />
        <result property="payrollSource" column="payroll_source" />
        <result property="createBy"   column="create_by"   />
        <result property="createTime" column="create_time" />
        <result property="updateBy"   column="update_by"   />
        <result property="updateTime" column="update_time" />
    </resultMap>

    <resultMap type="PsPayslip" id="PsPayslipResult">
        <result property="id" column="id"/>
        <result property="department" column="department"/>
        <result property="duration" column="duration"/>
        <result property="idNo" column="id_no"/>
        <result property="name" column="name"/>
        <result property="basicSalary" column="basic_salary"/>
        <result property="normalBonus" column="normal_bonus"/>
        <result property="annualBonus13thSalary" column="annual_bonus_13th_salary"/>
        <result property="allowanceSubsidy" column="allowance_subsidy"/>
        <result property="transportAllowance" column="transport_allowance"/>
        <result property="communicationAllowance" column="communication_allowance"/>
        <result property="mealAllowance" column="meal_allowance"/>
        <result property="birthdayGift" column="birthday_gift"/>
        <result property="otherAllowance" column="other_allowance"/>
        <result property="otPayment" column="OT_payment"/>
        <result property="affordTax" column="afford_tax"/>
        <result property="socialBenefitsBasis" column="social_benefits_basis"/>
        <result property="housingFundBasis" column="housing_fund_basis"/>
        <result property="pension" column="pension"/>
        <result property="medical" column="medical"/>
        <result property="unemployment" column="unemployment"/>
        <result property="housingFund" column="housing_fund"/>
        <result property="absence" column="absence"/>
        <result property="affairLeave" column="affair_leave"/>
        <result property="absenteeism" column="absenteeism"/>
        <result property="sickLeave" column="sick_leave"/>
        <result property="annuity" column="annuity"/>
        <result property="unionFee" column="union_fee"/>
        <result property="other" column="other"/>
        <result property="IIT" column="IIT"/>
        <result property="balanceCharge" column="balance_charge"/>
        <result property="expense" column="expense"/>
        <result property="foreignersSubsistence" column="foreigners_subsistence"/>
        <result property="netIncome" column="net_income"/>
        <result property="pretaxAdjustment" column="pre_tax_adjustment"/>
        <result property="shareIncentives" column="share_incentives"/>
        <result property="compensation" column="compensation"/>
        <result property="afterTaxAdjustment" column="after_tax_adjustment"/>
        <result property="kfFlag" column="kf_flag"/>
        <result property="czFlag" column="cz_flag"/>
        <result property="groupIds" column="group_ids"/>
        <result property="createBy" column="create_by"/>
        <result property="createTime" column="create_time"/>
        <result property="updateBy" column="update_by"/>
        <result property="updateTime" column="update_time"/>
        <result property="openTime" column="open_time"/>
        <result property="payDay" column="pay_day"/>
        <result property="psType" column="ps_type"/>
        <result property="taxCalculation" column="tax_calculation"/>
    </resultMap>

    <resultMap type="PsCoverInfo" id="PsCoverInfoResult">
        <result property="id"    column="id"    />
        <result property="duration"    column="duration"    />
        <result property="erNo"    column="er_no"    />
        <result property="erName"    column="er_name"    />
        <result property="currency"    column="currency"    />
        <result property="exchangeRate"    column="exchange_rate"    />
        <result property="groupIds"    column="group_ids"    />
        <result property="delFlag"    column="del_flag"    />
        <result property="createBy"    column="create_by"    />
        <result property="createTime"    column="create_time"    />
        <result property="updateBy"    column="update_by"    />
        <result property="updateTime"    column="update_time"    />
    </resultMap>

    <sql id="selectPsBasicInfoVo">
        select id, duration, er_name, id_no, name, en_name, sex, client_type, work_address, social_benefits_address, housing_fund_address,
               employment_nature, service_starttime, contract_address, contract_starttime, contract_endtime, leave_date, pre_after_tax,
               basic_salary, daily_salary, floating_salary, transport_allowance, communication_allowance, meal_allowance, other_fixed_allowance,
               msa_base, nsa_base, hwa_base, hwhf_base, phf_base, only_child_birthday, oca_base, fixed_subsidy, fixed_deduction,
               pension_base, medical_base, unemployment_base, maternity_base, work_related_injury_base, disability_base, housing_fund_base,
               shf_base, personal_pension, personal_medical, personal_unemployment, personal_housing_fund, personal_shf_te, personal_shf_nte,
               personal_medical_fixed_number, company_pension, company_medical, company_unemployment, company_maternity, company_work_related_injury,
               company_disability, company_housing_fund, company_shf, company_medical_fixed_number, company_wri_fixed_number,
               company_disability_fixed_number, annuity, union_fee, tax_not_issued, company_tax, fs_allowance, after_tax_deduction,
               tax_free_income, certificate_type, certificate_number, birthday, housing_fund_account, bank_accoun_name, bank_account,
               bank, department, post, nationality, nationality_code, payroll, telephone, mailbox, bill_address, postcode, residence_type,
               residence_address, commercial_insurance_cost, commercial_insurance_level, spouse_children_insurance, green_allowance,
               physical_examination, file_management_fee, annual_bonus_info, thirteen_salary_month, remarks, tax_payment_place, tax_free_item
                   accumulated_child_education, accumulated_continuing_education, accumulated_hli, accumulated_housing_rent, accumulated_sfte,
               commercial_health_insurance, tdp_insurance, other_tax_free_deductions, daily_attendance_days, monthly_award,
               quarter_award, overtime_150hours, overtime_200hours, overtime_300hours, full_attendance_days, eal_days, affair_leave_days,
               absent_eeism_days, sick_leave_days, sick_leave_deduction, transportation_fee, communication_fee, middle_shift_day,
               night_shift_days, high_temperature_days, oht_fee, hot_working_days, tahw_days, reissue, wage_deduction, pension_repayment,
               medical_repayment, unemployment_repayment, housing_fund_payment, tax_free_income2, tax_calculation, company_tax2, expense,
               expense_25, after_tax_reissue, after_tax_deduction2, Individual_tax_adjustment, annual_bonus, remarks2, csb_repayment,
               chf_repayment, cd_repayment, basic_deduction_adjustment, payroll_belong, bank_location, severance, birthday_gift,other_allowance, heating_fee, pay_sb_flag,
               pay_hf_flag, pay_iit_flag, client_code, employee_no, cost_center, actual_performance, performance_bonus_base, commission,
               other_bonus,pre_tax_adjustment,indemnity,indemnity_allowance,compensation_calculation_year,share_incentives,travel_allowance,accumulated_child_care from ps_basic_info p
    </sql>

    <sql id="selectPsCalculationResultVo">
        select p.id, p.duration, p.id_no, p.name, p.basic_salary, p.floating_salary, p.monthly_award,
               p.quarter_award, p.overtime_award_150, p.overtime_award_200, p.overtime_award_300,
               p.eala_deduction, p.al_deduction, p.absenteeism_deduction, p.sl_deduction, p.transportation_payment,
               p.communication_payment, p.meal_allowance, p.birthday_gift,p.other_benefits, p.middle_shift_payment, p.night_shift_payment,
               p.high_temperature_payment, p.hot_working_payment, p.tahw_payment, p.reissue, p.wage_deduction,
               p.pension, p.medical, p.unemployment, p.housing_fund, p.ste_housing_fund, p.social_benefits_adjustment,
               p.housing_fund_adjustment, p.annuity, p.union_fee, p.tax_calculation, p.pre_tax_income, p.basic_deduction,
               p.accumulated_ipti, p.accumulated_isiahf, p.accumulated_bd, p.accumulated_child_education,
               p.accumulated_continuing_education, p.accumulated_hli, p.accumulated_housing_rent, p.accumulated_sfte,
               p.accumulated_other, p.accumulated_tftd, p.accumulated_total_cost, p.accumulated_il, p.individual_llt, p.company_tax,
               p.company_total_tax, p.accumulated_ati, p.accumulated_bti, p.theoretical_income, p.accumulated_llt_cai, p.company_llt,
               p.only_child_allowance, p.snte_housing_fund, p.expense, p.expense_25, p.fs_allowance, p.after_tax_reissue, p.after_tax_deduction,
               p.annual_bonus, p.annual_bonus_llt, p.income, p.cost, p.net_income, p.company_pension, p.company_medical, p.company_unemployment,
               p.company_maternity, p.company_wri, p.company_disability, p.company_housing_fund, p.company_shf, p.accumulated_payroll_tax, p.employer_liability,
               p.deposit, p.service_fee, p.value_added_tax, p.other_bonus, p.pre_tax_adjustment, p.indemnity, p.indemnity_tax, p.share_incentives,
               p.share_incentives_tax, p.service_fee_tax,p.travel_allowance,p.accumulated_child_care from ps_calculation_result p
    </sql>

    <sql id="selectPsPayrollVo">
        select id, department, duration, id_no, name, net_income, expense, foreigner_allowance, ip_pension, ip_medical, ip_unemployment, ip_housing_fund, ip_annuity, ip_union_fee, IIT, balance_charge, ep_pension, ep_medical, ep_unemployment, ep_heating_fee, maternity, work_related_Injury, disability, ep_housing_fund, ep_annuity, ep_union_fee, commercial_insurance, other_benefits, service_fee, business_tax, deposit, employer_liability, office_seat, others, service_fee_tax, value_added_tax, total_cost, tax_free_item, remarks,payroll_source, group_ids, create_by, create_time, update_by, update_time from ps_payroll
    </sql>

    <sql id="selectVendorPsPayrollVo">
        select id, department, duration, id_no, name, net_income, expense, foreigner_allowance, ip_pension, ip_medical, ip_unemployment, ip_housing_fund, ip_annuity, ip_union_fee, IIT, balance_charge, ep_pension, ep_medical, ep_unemployment, ep_heating_fee, maternity, work_related_Injury, disability, ep_housing_fund, ep_annuity, ep_union_fee, commercial_insurance, other_benefits, service_fee, business_tax, deposit, employer_liability, office_seat, others, service_fee_tax, value_added_tax, total_cost, tax_free_item, remarks,payroll_source, group_ids, create_by, create_time, update_by, update_time from vendor_ps_payroll
    </sql>

    <sql id="selectPsPayslipVo">
        select id, department, duration, id_no, name, basic_salary, normal_bonus, annual_bonus_13th_salary, allowance_subsidy,
               transport_allowance,communication_allowance,meal_allowance,birthday_gift,other_allowance,
               OT_payment, afford_tax, social_benefits_basis, housing_fund_basis, pension, medical, unemployment, housing_fund,
               absence, affair_leave, absenteeism, sick_leave, annuity, union_fee, other, IIT, balance_charge, expense,
               foreigners_subsistence, net_income, kf_flag, cz_flag, pre_tax_adjustment, share_incentives, compensation,
               after_tax_adjustment, group_ids, create_by, create_time, update_by, update_time, open_time from ps_payslip
    </sql>

    <select id="selectPsBasicInfoCheckList" parameterType="PsBasicInfo" resultMap="PsBasicInfoResult">
        <include refid="selectPsBasicInfoVo"/>
        <where>
            <if test="duration != null and duration != ''"> and duration = #{duration}</if>
            <if test="idNo != null  and idNo != ''"> and id_no = #{idNo}</if>
            <if test="clientCode != null and clientCode != ''"> and client_code = #{clientCode}</if>
        </where>
        order by p.duration desc,p.id_no
    </select>

    <select id="selectPsBasicInfo" parameterType="PsBasicInfo" resultMap="PsBasicInfoResult">
        <include refid="selectPsBasicInfoVo"/>
        <where>
            <if test="duration != null and duration != ''"> and duration = #{duration}</if>
            <if test="idNo != null  and idNo != ''"> and id_no = #{idNo}</if>
            <if test="clientCode != null and clientCode != ''"> and client_code = #{clientCode}</if>
        </where>
        order by p.duration desc,p.id_no
    </select>

    <insert id="insertPsBasicInfo" parameterType="PsBasicInfo" useGeneratedKeys="true" keyProperty="id">
        insert into ps_basic_info
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="duration != null">duration,</if>
            <if test="erName != null">er_name,</if>
            <if test="idNo != null">id_no,</if>
            <if test="name != null">name,</if>
            <if test="enName != null">en_name,</if>
            <if test="sex != null">sex,</if>
            <if test="clientType != null">client_type,</if>
            <if test="workAddress != null">work_address,</if>
            <if test="socialBenefitsAddress != null">social_benefits_address,</if>
            <if test="housingFundAddress != null">housing_fund_address,</if>
            <if test="employmentNature != null">employment_nature,</if>
            <if test="serviceStarttime != null">service_starttime,</if>
            <if test="contractAddress != null">contract_address,</if>
            <if test="contractStarttime != null">contract_starttime,</if>
            <if test="contractEndtime != null">contract_endtime,</if>
            <if test="leaveDate != null">leave_date,</if>
            <if test="preAfterTax != null">pre_after_tax,</if>
            <if test="basicSalary != null">basic_salary,</if>
            <if test="dailySalary != null">daily_salary,</if>
            <if test="floatingSalary != null">floating_salary,</if>
            <if test="transportAllowance != null">transport_allowance,</if>
            <if test="communicationAllowance != null">communication_allowance,</if>
            <if test="mealAllowance != null">meal_allowance,</if>
            <if test="otherFixedAllowance != null">other_fixed_allowance,</if>
            <if test="msaBase != null">msa_base,</if>
            <if test="nsaBase != null">nsa_base,</if>
            <if test="hwaBase != null">hwa_base,</if>
            <if test="hwhfBase != null">hwhf_base,</if>
            <if test="phfBase != null">phf_base,</if>
            <if test="onlyChildBirthday != null">only_child_birthday,</if>
            <if test="ocaBase != null">oca_base,</if>
            <if test="fixedSubsidy != null">fixed_subsidy,</if>
            <if test="fixedDeduction != null">fixed_deduction,</if>
            <if test="pensionBase != null">pension_base,</if>
            <if test="medicalBase != null">medical_base,</if>
            <if test="unemploymentBase != null">unemployment_base,</if>
            <if test="maternityBase != null">maternity_base,</if>
            <if test="workRelatedInjuryBase != null">work_related_injury_base,</if>
            <if test="disabilityBase != null">disability_base,</if>
            <if test="housingFundBase != null">housing_fund_base,</if>
            <if test="shfBase != null">shf_base,</if>
            <if test="personalPension != null">personal_pension,</if>
            <if test="personalMedical != null">personal_medical,</if>
            <if test="personalUnemployment != null">personal_unemployment,</if>
            <if test="personalHousingFund != null">personal_housing_fund,</if>
            <if test="personalShfTe != null">personal_shf_te,</if>
            <if test="personalShfNte != null">personal_shf_nte,</if>
            <if test="personalMedicalFixedNumber != null">personal_medical_fixed_number,</if>
            <if test="companyPension != null">company_pension,</if>
            <if test="companyMedical != null">company_medical,</if>
            <if test="companyUnemployment != null">company_unemployment,</if>
            <if test="companyMaternity != null">company_maternity,</if>
            <if test="companyWorkRelatedInjury != null">company_work_related_injury,</if>
            <if test="companyDisability != null">company_disability,</if>
            <if test="companyHousingFund != null">company_housing_fund,</if>
            <if test="companyShf != null">company_shf,</if>
            <if test="companyMedicalFixedNumber != null">company_medical_fixed_number,</if>
            <if test="companyWriFixedNumber != null">company_wri_fixed_number,</if>
            <if test="companyDisabilityFixedNumber != null">company_disability_fixed_number,</if>
            <if test="annuity != null">annuity,</if>
            <if test="unionFee != null">union_fee,</if>
            <if test="taxNotIssued != null">tax_not_issued,</if>
            <if test="companyTax != null">company_tax,</if>
            <if test="fsAllowance != null">fs_allowance,</if>
            <if test="afterTaxDeduction != null">after_tax_deduction,</if>
            <if test="taxFreeIncome != null">tax_free_income,</if>
            <if test="certificateType != null">certificate_type,</if>
            <if test="certificateNumber != null">certificate_number,</if>
            <if test="birthday != null">birthday,</if>
            <if test="housingFundAccount != null">housing_fund_account,</if>
            <if test="bankAccounName != null">bank_accoun_name,</if>
            <if test="bankAccount != null">bank_account,</if>
            <if test="bank != null">bank,</if>
            <if test="department != null">department,</if>
            <if test="post != null">post,</if>
            <if test="nationality != null">nationality,</if>
            <if test="nationalityCode != null">nationality_code,</if>
            <if test="payroll != null">payroll,</if>
            <if test="telephone != null">telephone,</if>
            <if test="mailbox != null">mailbox,</if>
            <if test="billAddress != null">bill_address,</if>
            <if test="postcode != null">postcode,</if>
            <if test="residenceType != null">residence_type,</if>
            <if test="residenceAddress != null">residence_address,</if>
            <if test="commercialInsuranceCost != null">commercial_insurance_cost,</if>
            <if test="commercialInsuranceLevel != null">commercial_insurance_level,</if>
            <if test="spouseChildrenInsurance != null">spouse_children_insurance,</if>
            <if test="greenAllowance != null">green_allowance,</if>
            <if test="physicalExamination != null">physical_examination,</if>
            <if test="fileManagementFee != null">file_management_fee,</if>
            <if test="annualBonusInfo != null">annual_bonus_info,</if>
            <if test="thirteenSalaryMonth != null">thirteen_salary_month,</if>
            <if test="remarks != null">remarks,</if>
            <if test="taxPaymentPlace != null">tax_payment_place,</if>
            <if test="taxFreeItem != null">tax_free_item,</if>
            <if test="accumulatedChildEducation != null">accumulated_child_education,</if>
            <if test="accumulatedContinuingEducation != null">accumulated_continuing_education,</if>
            <if test="accumulatedHli != null">accumulated_hli,</if>
            <if test="accumulatedHousingRent != null">accumulated_housing_rent,</if>
            <if test="accumulatedSfte != null">accumulated_sfte,</if>
            <if test="commercialHealthInsurance != null">commercial_health_insurance,</if>
            <if test="tdpInsurance != null">tdp_insurance,</if>
            <if test="otherTaxFreeDeductions != null">other_tax_free_deductions,</if>
            <if test="dailyAttendanceDays != null">daily_attendance_days,</if>
            <if test="monthlyAward != null">monthly_award,</if>
            <if test="quarterAward != null">quarter_award,</if>
            <if test="overtime150hours != null">overtime_150hours,</if>
            <if test="overtime200hours != null">overtime_200hours,</if>
            <if test="overtime300hours != null">overtime_300hours,</if>
            <if test="fullAttendanceDays != null">full_attendance_days,</if>
            <if test="ealDays != null">eal_days,</if>
            <if test="affairLeaveDays != null">affair_leave_days,</if>
            <if test="absentEeismDays != null">absent_eeism_days,</if>
            <if test="sickLeaveDays != null">sick_leave_days,</if>
            <if test="sickLeaveDeduction != null">sick_leave_deduction,</if>
            <if test="transportationFee != null">transportation_fee,</if>
            <if test="communicationFee != null">communication_fee,</if>
            <if test="middleShiftDay != null">middle_shift_day,</if>
            <if test="nightShiftDays != null">night_shift_days,</if>
            <if test="highTemperatureDays != null">high_temperature_days,</if>
            <if test="ohtFee != null">oht_fee,</if>
            <if test="hotWorkingDays != null">hot_working_days,</if>
            <if test="tahwDays != null">tahw_days,</if>
            <if test="reissue != null">reissue,</if>
            <if test="wageDeduction != null">wage_deduction,</if>
            <if test="pensionRepayment != null">pension_repayment,</if>
            <if test="medicalRepayment != null">medical_repayment,</if>
            <if test="unemploymentRepayment != null">unemployment_repayment,</if>
            <if test="housingFundPayment != null">housing_fund_payment,</if>
            <if test="taxFreeIncome2 != null">tax_free_income2,</if>
            <if test="taxCalculation != null">tax_calculation,</if>
            <if test="companyTax2 != null">company_tax2,</if>
            <if test="expense != null">expense,</if>
            <if test="expense25 != null">expense_25,</if>
            <if test="afterTaxReissue != null">after_tax_reissue,</if>
            <if test="afterTaxDeduction2 != null">after_tax_deduction2,</if>
            <if test="individualTaxAdjustment != null">Individual_tax_adjustment,</if>
            <if test="annualBonus != null">annual_bonus,</if>
            <if test="remarks2 != null">remarks2,</if>
            <if test="csbRepayment != null">csb_repayment,</if>
            <if test="chfRepayment != null">chf_repayment,</if>
            <if test="cdRepayment != null">cd_repayment,</if>
            <if test="basicDeductionAdjustment != null">basic_deduction_adjustment,</if>
            <if test="payrollBelong != null">payroll_belong,</if>
            <if test="bankLocation != null">bank_location,</if>
            <if test="severance != null">severance,</if>
            <if test="birthdayGift != null">birthday_gift,</if>
            <if test="otherAllowance != null">other_allowance,</if>
            <if test="heatingFee != null">heating_fee,</if>
            <if test="paySBFlag != null">pay_sb_flag,</if>
            <if test="payHFFlag != null">pay_hf_flag,</if>
            <if test="payIITFlag != null">pay_iit_flag,</if>
            <if test="clientCode != null">client_code,</if>
            <if test="employeeNo != null">employee_no,</if>
            <if test="costCenter != null">cost_center,</if>
            <if test="actualPerformance != null">actual_performance,</if>
            <if test="performanceBonusBase != null">performance_bonus_base,</if>
            <if test="commission != null">commission,</if>
            <if test="otherBonus != null">other_bonus,</if>
            <if test="pretaxAdjustment != null">pre_tax_adjustment,</if>
            <if test="indemnity != null">indemnity,</if>
            <if test="indemnityAllowance != null">indemnity_allowance,</if>
            <if test="compensationCalculationYear != null">compensation_calculation_year,</if>
            <if test="shareIncentives != null">share_incentives,</if>
            <if test="travelAllowance != null">travel_allowance,</if>
            <if test="accumulatedChildCare != null">accumulated_child_care,</if>
            <if test="groupIds != null and groupIds !=''">group_ids,</if>
            <if test="createBy != null and createBy != ''">create_by,</if>
            create_time
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="duration != null">#{duration},</if>
            <if test="erName != null">#{erName},</if>
            <if test="idNo != null">#{idNo},</if>
            <if test="name != null">#{name},</if>
            <if test="enName != null">#{enName},</if>
            <if test="sex != null">#{sex},</if>
            <if test="clientType != null">#{clientType},</if>
            <if test="workAddress != null">#{workAddress},</if>
            <if test="socialBenefitsAddress != null">#{socialBenefitsAddress},</if>
            <if test="housingFundAddress != null">#{housingFundAddress},</if>
            <if test="employmentNature != null">#{employmentNature},</if>
            <if test="serviceStarttime != null">#{serviceStarttime},</if>
            <if test="contractAddress != null">#{contractAddress},</if>
            <if test="contractStarttime != null">#{contractStarttime},</if>
            <if test="contractEndtime != null">#{contractEndtime},</if>
            <if test="leaveDate != null">#{leaveDate},</if>
            <if test="preAfterTax != null">#{preAfterTax},</if>
            <if test="basicSalary != null">#{basicSalary},</if>
            <if test="dailySalary != null">#{dailySalary},</if>
            <if test="floatingSalary != null">#{floatingSalary},</if>
            <if test="transportAllowance != null">#{transportAllowance},</if>
            <if test="communicationAllowance != null">#{communicationAllowance},</if>
            <if test="mealAllowance != null">#{mealAllowance},</if>
            <if test="otherFixedAllowance != null">#{otherFixedAllowance},</if>
            <if test="msaBase != null">#{msaBase},</if>
            <if test="nsaBase != null">#{nsaBase},</if>
            <if test="hwaBase != null">#{hwaBase},</if>
            <if test="hwhfBase != null">#{hwhfBase},</if>
            <if test="phfBase != null">#{phfBase},</if>
            <if test="onlyChildBirthday != null">#{onlyChildBirthday},</if>
            <if test="ocaBase != null">#{ocaBase},</if>
            <if test="fixedSubsidy != null">#{fixedSubsidy},</if>
            <if test="fixedDeduction != null">#{fixedDeduction},</if>
            <if test="pensionBase != null">#{pensionBase},</if>
            <if test="medicalBase != null">#{medicalBase},</if>
            <if test="unemploymentBase != null">#{unemploymentBase},</if>
            <if test="maternityBase != null">#{maternityBase},</if>
            <if test="workRelatedInjuryBase != null">#{workRelatedInjuryBase},</if>
            <if test="disabilityBase != null">#{disabilityBase},</if>
            <if test="housingFundBase != null">#{housingFundBase},</if>
            <if test="shfBase != null">#{shfBase},</if>
            <if test="personalPension != null">#{personalPension},</if>
            <if test="personalMedical != null">#{personalMedical},</if>
            <if test="personalUnemployment != null">#{personalUnemployment},</if>
            <if test="personalHousingFund != null">#{personalHousingFund},</if>
            <if test="personalShfTe != null">#{personalShfTe},</if>
            <if test="personalShfNte != null">#{personalShfNte},</if>
            <if test="personalMedicalFixedNumber != null">#{personalMedicalFixedNumber},</if>
            <if test="companyPension != null">#{companyPension},</if>
            <if test="companyMedical != null">#{companyMedical},</if>
            <if test="companyUnemployment != null">#{companyUnemployment},</if>
            <if test="companyMaternity != null">#{companyMaternity},</if>
            <if test="companyWorkRelatedInjury != null">#{companyWorkRelatedInjury},</if>
            <if test="companyDisability != null">#{companyDisability},</if>
            <if test="companyHousingFund != null">#{companyHousingFund},</if>
            <if test="companyShf != null">#{companyShf},</if>
            <if test="companyMedicalFixedNumber != null">#{companyMedicalFixedNumber},</if>
            <if test="companyWriFixedNumber != null">#{companyWriFixedNumber},</if>
            <if test="companyDisabilityFixedNumber != null">#{companyDisabilityFixedNumber},</if>
            <if test="annuity != null">#{annuity},</if>
            <if test="unionFee != null">#{unionFee},</if>
            <if test="taxNotIssued != null">#{taxNotIssued},</if>
            <if test="companyTax != null">#{companyTax},</if>
            <if test="fsAllowance != null">#{fsAllowance},</if>
            <if test="afterTaxDeduction != null">#{afterTaxDeduction},</if>
            <if test="taxFreeIncome != null">#{taxFreeIncome},</if>
            <if test="certificateType != null">#{certificateType},</if>
            <if test="certificateNumber != null">#{certificateNumber},</if>
            <if test="birthday != null">#{birthday},</if>
            <if test="housingFundAccount != null">#{housingFundAccount},</if>
            <if test="bankAccounName != null">#{bankAccounName},</if>
            <if test="bankAccount != null">#{bankAccount},</if>
            <if test="bank != null">#{bank},</if>
            <if test="department != null">#{department},</if>
            <if test="post != null">#{post},</if>
            <if test="nationality != null">#{nationality},</if>
            <if test="nationalityCode != null">#{nationalityCode},</if>
            <if test="payroll != null">#{payroll},</if>
            <if test="telephone != null">#{telephone},</if>
            <if test="mailbox != null">#{mailbox},</if>
            <if test="billAddress != null">#{billAddress},</if>
            <if test="postcode != null">#{postcode},</if>
            <if test="residenceType != null">#{residenceType},</if>
            <if test="residenceAddress != null">#{residenceAddress},</if>
            <if test="commercialInsuranceCost != null">#{commercialInsuranceCost},</if>
            <if test="commercialInsuranceLevel != null">#{commercialInsuranceLevel},</if>
            <if test="spouseChildrenInsurance != null">#{spouseChildrenInsurance},</if>
            <if test="greenAllowance != null">#{greenAllowance},</if>
            <if test="physicalExamination != null">#{physicalExamination},</if>
            <if test="fileManagementFee != null">#{fileManagementFee},</if>
            <if test="annualBonusInfo != null">#{annualBonusInfo},</if>
            <if test="thirteenSalaryMonth != null">#{thirteenSalaryMonth},</if>
            <if test="remarks != null">#{remarks},</if>
            <if test="taxPaymentPlace != null">#{taxPaymentPlace},</if>
            <if test="taxFreeItem != null">#{taxFreeItem},</if>
            <if test="accumulatedChildEducation != null">#{accumulatedChildEducation},</if>
            <if test="accumulatedContinuingEducation != null">#{accumulatedContinuingEducation},</if>
            <if test="accumulatedHli != null">#{accumulatedHli},</if>
            <if test="accumulatedHousingRent != null">#{accumulatedHousingRent},</if>
            <if test="accumulatedSfte != null">#{accumulatedSfte},</if>
            <if test="commercialHealthInsurance != null">#{commercialHealthInsurance},</if>
            <if test="tdpInsurance != null">#{tdpInsurance},</if>
            <if test="otherTaxFreeDeductions != null">#{otherTaxFreeDeductions},</if>
            <if test="dailyAttendanceDays != null">#{dailyAttendanceDays},</if>
            <if test="monthlyAward != null">#{monthlyAward},</if>
            <if test="quarterAward != null">#{quarterAward},</if>
            <if test="overtime150hours != null">#{overtime150hours},</if>
            <if test="overtime200hours != null">#{overtime200hours},</if>
            <if test="overtime300hours != null">#{overtime300hours},</if>
            <if test="fullAttendanceDays != null">#{fullAttendanceDays},</if>
            <if test="ealDays != null">#{ealDays},</if>
            <if test="affairLeaveDays != null">#{affairLeaveDays},</if>
            <if test="absentEeismDays != null">#{absentEeismDays},</if>
            <if test="sickLeaveDays != null">#{sickLeaveDays},</if>
            <if test="sickLeaveDeduction != null">#{sickLeaveDeduction},</if>
            <if test="transportationFee != null">#{transportationFee},</if>
            <if test="communicationFee != null">#{communicationFee},</if>
            <if test="middleShiftDay != null">#{middleShiftDay},</if>
            <if test="nightShiftDays != null">#{nightShiftDays},</if>
            <if test="highTemperatureDays != null">#{highTemperatureDays},</if>
            <if test="ohtFee != null">#{ohtFee},</if>
            <if test="hotWorkingDays != null">#{hotWorkingDays},</if>
            <if test="tahwDays != null">#{tahwDays},</if>
            <if test="reissue != null">#{reissue},</if>
            <if test="wageDeduction != null">#{wageDeduction},</if>
            <if test="pensionRepayment != null">#{pensionRepayment},</if>
            <if test="medicalRepayment != null">#{medicalRepayment},</if>
            <if test="unemploymentRepayment != null">#{unemploymentRepayment},</if>
            <if test="housingFundPayment != null">#{housingFundPayment},</if>
            <if test="taxFreeIncome2 != null">#{taxFreeIncome2},</if>
            <if test="taxCalculation != null">#{taxCalculation},</if>
            <if test="companyTax2 != null">#{companyTax2},</if>
            <if test="expense != null">#{expense},</if>
            <if test="expense25 != null">#{expense25},</if>
            <if test="afterTaxReissue != null">#{afterTaxReissue},</if>
            <if test="afterTaxDeduction2 != null">#{afterTaxDeduction2},</if>
            <if test="individualTaxAdjustment != null">#{individualTaxAdjustment},</if>
            <if test="annualBonus != null">#{annualBonus},</if>
            <if test="remarks2 != null">#{remarks2},</if>
            <if test="csbRepayment != null">#{csbRepayment},</if>
            <if test="chfRepayment != null">#{chfRepayment},</if>
            <if test="cdRepayment != null">#{cdRepayment},</if>
            <if test="basicDeductionAdjustment != null">#{basicDeductionAdjustment},</if>
            <if test="payrollBelong != null">#{payrollBelong},</if>
            <if test="bankLocation != null">#{bankLocation},</if>
            <if test="severance != null">#{severance},</if>
            <if test="birthdayGift != null">#{birthdayGift},</if>
            <if test="otherAllowance != null">#{otherAllowance},</if>
            <if test="heatingFee != null">#{heatingFee},</if>
            <if test="paySBFlag != null">#{paySBFlag},</if>
            <if test="payHFFlag != null">#{payHFFlag},</if>
            <if test="payIITFlag != null">#{payIITFlag},</if>
            <if test="clientCode != null">#{clientCode},</if>
            <if test="employeeNo != null">#{employeeNo},</if>
            <if test="costCenter != null">#{costCenter},</if>
            <if test="actualPerformance != null">#{actualPerformance},</if>
            <if test="performanceBonusBase != null">#{performanceBonusBase},</if>
            <if test="commission != null">#{commission},</if>
            <if test="otherBonus != null">#{otherBonus},</if>
            <if test="pretaxAdjustment != null">#{pretaxAdjustment},</if>
            <if test="indemnity != null">#{indemnity},</if>
            <if test="indemnityAllowance != null">#{indemnityAllowance},</if>
            <if test="compensationCalculationYear != null">#{compensationCalculationYear},</if>
            <if test="shareIncentives != null">#{shareIncentives},</if>
            <if test="travelAllowance != null">#{travelAllowance},</if>
            <if test="accumulatedChildCare != null">#{accumulatedChildCare},</if>
            <if test="groupIds != null and groupIds !=''">#{groupIds},</if>
            <if test="createBy != null and createBy != ''">#{createBy},</if>
            sysdate()
        </trim>
    </insert>

    <update id="updatePsBasicInfo" parameterType="PsBasicInfo">
        update ps_basic_info
        <trim prefix="SET" suffixOverrides=",">
            <if test="duration != null">duration = #{duration},</if>
            <if test="erName != null">er_name = #{erName},</if>
            <if test="idNo != null">id_no = #{idNo},</if>
            <if test="name != null">name = #{name},</if>
            <if test="enName != null">en_name = #{enName},</if>
            <if test="sex != null">sex = #{sex},</if>
            <if test="clientType != null">client_type = #{clientType},</if>
            <if test="workAddress != null">work_address = #{workAddress},</if>
            <if test="socialBenefitsAddress != null">social_benefits_address = #{socialBenefitsAddress},</if>
            <if test="housingFundAddress != null">housing_fund_address = #{housingFundAddress},</if>
            <if test="employmentNature != null">employment_nature = #{employmentNature},</if>
            <if test="serviceStarttime != null">service_starttime = #{serviceStarttime},</if>
            <if test="contractAddress != null">contract_address = #{contractAddress},</if>
            <if test="contractStarttime != null">contract_starttime = #{contractStarttime},</if>
            <if test="contractEndtime != null">contract_endtime = #{contractEndtime},</if>
            <if test="leaveDate != null">leave_date = #{leaveDate},</if>
            <if test="preAfterTax != null">pre_after_tax = #{preAfterTax},</if>
            <if test="basicSalary != null">basic_salary = #{basicSalary},</if>
            <if test="dailySalary != null">daily_salary = #{dailySalary},</if>
            <if test="floatingSalary != null">floating_salary = #{floatingSalary},</if>
            <if test="transportAllowance != null">transport_allowance = #{transportAllowance},</if>
            <if test="communicationAllowance != null">communication_allowance = #{communicationAllowance},</if>
            <if test="mealAllowance != null">meal_allowance = #{mealAllowance},</if>
            <if test="otherFixedAllowance != null">other_fixed_allowance = #{otherFixedAllowance},</if>
            <if test="msaBase != null">msa_base = #{msaBase},</if>
            <if test="nsaBase != null">nsa_base = #{nsaBase},</if>
            <if test="hwaBase != null">hwa_base = #{hwaBase},</if>
            <if test="hwhfBase != null">hwhf_base = #{hwhfBase},</if>
            <if test="phfBase != null">phf_base = #{phfBase},</if>
            <if test="onlyChildBirthday != null">only_child_birthday = #{onlyChildBirthday},</if>
            <if test="ocaBase != null">oca_base = #{ocaBase},</if>
            <if test="fixedSubsidy != null">fixed_subsidy = #{fixedSubsidy},</if>
            <if test="fixedDeduction != null">fixed_deduction = #{fixedDeduction},</if>
            <if test="pensionBase != null">pension_base = #{pensionBase},</if>
            <if test="medicalBase != null">medical_base = #{medicalBase},</if>
            <if test="unemploymentBase != null">unemployment_base = #{unemploymentBase},</if>
            <if test="maternityBase != null">maternity_base = #{maternityBase},</if>
            <if test="workRelatedInjuryBase != null">work_related_injury_base = #{workRelatedInjuryBase},</if>
            <if test="disabilityBase != null">disability_base = #{disabilityBase},</if>
            <if test="housingFundBase != null">housing_fund_base = #{housingFundBase},</if>
            <if test="shfBase != null">shf_base = #{shfBase},</if>
            <if test="personalPension != null">personal_pension = #{personalPension},</if>
            <if test="personalMedical != null">personal_medical = #{personalMedical},</if>
            <if test="personalUnemployment != null">personal_unemployment = #{personalUnemployment},</if>
            <if test="personalHousingFund != null">personal_housing_fund = #{personalHousingFund},</if>
            <if test="personalShfTe != null">personal_shf_te = #{personalShfTe},</if>
            <if test="personalShfNte != null">personal_shf_nte = #{personalShfNte},</if>
            <if test="personalMedicalFixedNumber != null">personal_medical_fixed_number = #{personalMedicalFixedNumber},</if>
            <if test="companyPension != null">company_pension = #{companyPension},</if>
            <if test="companyMedical != null">company_medical = #{companyMedical},</if>
            <if test="companyUnemployment != null">company_unemployment = #{companyUnemployment},</if>
            <if test="companyMaternity != null">company_maternity = #{companyMaternity},</if>
            <if test="companyWorkRelatedInjury != null">company_work_related_injury = #{companyWorkRelatedInjury},</if>
            <if test="companyDisability != null">company_disability = #{companyDisability},</if>
            <if test="companyHousingFund != null">company_housing_fund = #{companyHousingFund},</if>
            <if test="companyShf != null">company_shf = #{companyShf},</if>
            <if test="companyMedicalFixedNumber != null">company_medical_fixed_number = #{companyMedicalFixedNumber},</if>
            <if test="companyWriFixedNumber != null">company_wri_fixed_number = #{companyWriFixedNumber},</if>
            <if test="companyDisabilityFixedNumber != null">company_disability_fixed_number = #{companyDisabilityFixedNumber},</if>
            <if test="annuity != null">annuity = #{annuity},</if>
            <if test="unionFee != null">union_fee = #{unionFee},</if>
            <if test="taxNotIssued != null">tax_not_issued = #{taxNotIssued},</if>
            <if test="companyTax != null">company_tax = #{companyTax},</if>
            <if test="fsAllowance != null">fs_allowance = #{fsAllowance},</if>
            <if test="afterTaxDeduction != null">after_tax_deduction = #{afterTaxDeduction},</if>
            <if test="taxFreeIncome != null">tax_free_income = #{taxFreeIncome},</if>
            <if test="certificateType != null">certificate_type = #{certificateType},</if>
            <if test="certificateNumber != null">certificate_number = #{certificateNumber},</if>
            <if test="birthday != null">birthday = #{birthday},</if>
            <if test="housingFundAccount != null">housing_fund_account = #{housingFundAccount},</if>
            <if test="bankAccounName != null">bank_accoun_name = #{bankAccounName},</if>
            <if test="bankAccount != null">bank_account = #{bankAccount},</if>
            <if test="bank != null">bank = #{bank},</if>
            <if test="department != null">department = #{department},</if>
            <if test="post != null">post = #{post},</if>
            <if test="nationality != null">nationality = #{nationality},</if>
            <if test="nationalityCode != null">nationality_code = #{nationalityCode},</if>
            <if test="payroll != null">payroll = #{payroll},</if>
            <if test="telephone != null">telephone = #{telephone},</if>
            <if test="mailbox != null">mailbox = #{mailbox},</if>
            <if test="billAddress != null">bill_address = #{billAddress},</if>
            <if test="postcode != null">postcode = #{postcode},</if>
            <if test="residenceType != null">residence_type = #{residenceType},</if>
            <if test="residenceAddress != null">residence_address = #{residenceAddress},</if>
            <if test="commercialInsuranceCost != null">commercial_insurance_cost = #{commercialInsuranceCost},</if>
            <if test="commercialInsuranceLevel != null">commercial_insurance_level = #{commercialInsuranceLevel},</if>
            <if test="spouseChildrenInsurance != null">spouse_children_insurance = #{spouseChildrenInsurance},</if>
            <if test="greenAllowance != null">green_allowance = #{greenAllowance},</if>
            <if test="physicalExamination != null">physical_examination = #{physicalExamination},</if>
            <if test="fileManagementFee != null">file_management_fee = #{fileManagementFee},</if>
            <if test="annualBonusInfo != null">annual_bonus_info = #{annualBonusInfo},</if>
            <if test="thirteenSalaryMonth != null">thirteen_salary_month = #{thirteenSalaryMonth},</if>
            <if test="remarks != null">remarks = #{remarks},</if>
            <if test="taxPaymentPlace != null">tax_payment_place = #{taxPaymentPlace},</if>
            <if test="taxFreeItem != null">tax_free_item = #{taxFreeItem},</if>
            <if test="accumulatedChildEducation != null">accumulated_child_education = #{accumulatedChildEducation},</if>
            <if test="accumulatedContinuingEducation != null">accumulated_continuing_education = #{accumulatedContinuingEducation},</if>
            <if test="accumulatedHli != null">accumulated_hli = #{accumulatedHli},</if>
            <if test="accumulatedHousingRent != null">accumulated_housing_rent = #{accumulatedHousingRent},</if>
            <if test="accumulatedSfte != null">accumulated_sfte = #{accumulatedSfte},</if>
            <if test="commercialHealthInsurance != null">commercial_health_insurance = #{commercialHealthInsurance},</if>
            <if test="tdpInsurance != null">tdp_insurance = #{tdpInsurance},</if>
            <if test="otherTaxFreeDeductions != null">other_tax_free_deductions = #{otherTaxFreeDeductions},</if>
            <if test="dailyAttendanceDays != null">daily_attendance_days = #{dailyAttendanceDays},</if>
            <if test="monthlyAward != null">monthly_award = #{monthlyAward},</if>
            <if test="quarterAward != null">quarter_award = #{quarterAward},</if>
            <if test="overtime150hours != null">overtime_150hours = #{overtime150hours},</if>
            <if test="overtime200hours != null">overtime_200hours = #{overtime200hours},</if>
            <if test="overtime300hours != null">overtime_300hours = #{overtime300hours},</if>
            <if test="fullAttendanceDays != null">full_attendance_days = #{fullAttendanceDays},</if>
            <if test="ealDays != null">eal_days = #{ealDays},</if>
            <if test="affairLeaveDays != null">affair_leave_days = #{affairLeaveDays},</if>
            <if test="absentEeismDays != null">absent_eeism_days = #{absentEeismDays},</if>
            <if test="sickLeaveDays != null">sick_leave_days = #{sickLeaveDays},</if>
            <if test="sickLeaveDeduction != null">sick_leave_deduction = #{sickLeaveDeduction},</if>
            <if test="transportationFee != null">transportation_fee = #{transportationFee},</if>
            <if test="communicationFee != null">communication_fee = #{communicationFee},</if>
            <if test="middleShiftDay != null">middle_shift_day = #{middleShiftDay},</if>
            <if test="nightShiftDays != null">night_shift_days = #{nightShiftDays},</if>
            <if test="highTemperatureDays != null">high_temperature_days = #{highTemperatureDays},</if>
            <if test="ohtFee != null">oht_fee = #{ohtFee},</if>
            <if test="hotWorkingDays != null">hot_working_days = #{hotWorkingDays},</if>
            <if test="tahwDays != null">tahw_days = #{tahwDays},</if>
            <if test="reissue != null">reissue = #{reissue},</if>
            <if test="wageDeduction != null">wage_deduction = #{wageDeduction},</if>
            <if test="pensionRepayment != null">pension_repayment = #{pensionRepayment},</if>
            <if test="medicalRepayment != null">medical_repayment = #{medicalRepayment},</if>
            <if test="unemploymentRepayment != null">unemployment_repayment = #{unemploymentRepayment},</if>
            <if test="housingFundPayment != null">housing_fund_payment = #{housingFundPayment},</if>
            <if test="taxFreeIncome2 != null">tax_free_income2 = #{taxFreeIncome2},</if>
            <if test="taxCalculation != null">tax_calculation = #{taxCalculation},</if>
            <if test="companyTax2 != null">company_tax2 = #{companyTax2},</if>
            <if test="expense != null">expense = #{expense},</if>
            <if test="expense25 != null">expense_25 = #{expense25},</if>
            <if test="afterTaxReissue != null">after_tax_reissue = #{afterTaxReissue},</if>
            <if test="afterTaxDeduction2 != null">after_tax_deduction2 = #{afterTaxDeduction2},</if>
            <if test="individualTaxAdjustment != null">Individual_tax_adjustment = #{individualTaxAdjustment},</if>
            <if test="annualBonus != null">annual_bonus = #{annualBonus},</if>
            <if test="remarks2 != null">remarks2 = #{remarks2},</if>
            <if test="csbRepayment != null">csb_repayment = #{csbRepayment},</if>
            <if test="chfRepayment != null">chf_repayment = #{chfRepayment},</if>
            <if test="cdRepayment != null">cd_repayment = #{cdRepayment},</if>
            <if test="basicDeductionAdjustment != null">basic_deduction_adjustment = #{basicDeductionAdjustment},</if>
            <if test="payrollBelong != null">payroll_belong = #{payrollBelong},</if>
            <if test="bankLocation != null">bank_location = #{bankLocation},</if>
            <if test="severance != null">severance = #{severance},</if>
            <if test="birthdayGift != null">birthday_gift = #{birthdayGift},</if>
            <if test="otherAllowance != null">other_allowance = #{otherAllowance},</if>
            <if test="heatingFee != null">heating_fee = #{heatingFee},</if>
            <if test="paySBFlag != null">pay_sb_flag = #{paySBFlag},</if>
            <if test="payHFFlag != null">pay_hf_flag = #{payHFFlag},</if>
            <if test="payIITFlag != null">pay_iit_flag = #{payIITFlag},</if>
            <if test="clientCode != null">client_code = #{clientCode},</if>
            <if test="employeeNo != null">employee_no = #{employeeNo},</if>
            <if test="costCenter != null">cost_center = #{costCenter},</if>
            <if test="actualPerformance != null">actual_performance = #{actualPerformance},</if>
            <if test="performanceBonusBase != null">performance_bonus_base = #{performanceBonusBase},</if>
            <if test="commission != null">commission = #{commission},</if>
            <if test="otherBonus != null">other_bonus = #{otherBonus},</if>
            <if test="pretaxAdjustment != null">pre_tax_adjustment = #{pretaxAdjustment},</if>
            <if test="indemnity != null">indemnity = #{indemnity},</if>
            <if test="indemnityAllowance != null">indemnity_allowance = #{indemnityAllowance},</if>
            <if test="compensationCalculationYear != null">compensation_calculation_year = #{compensationCalculationYear},</if>
            <if test="shareIncentives != null">share_incentives = #{shareIncentives},</if>
            <if test="travelAllowance != null">travel_allowance = #{travelAllowance},</if>
            <if test="accumulatedChildCare != null">accumulated_child_care = #{accumulatedChildCare},</if>
            <if test="groupIds != null and groupIds !=''">group_ids = #{groupIds},</if>
            <if test="updateBy != null and updateBy != ''">update_by = #{updateBy},</if>
            update_time = sysdate()
        </trim>
        where id_no = #{idNo} and duration = #{duration}
    </update>



    <select id="selectPsCalculationResultCheckList" parameterType="PsCalculationResult" resultMap="PsCalculationResultResult">
        <include refid="selectPsCalculationResultVo"/>
        <where>
            <if test="duration != null and duration != ''"> and duration = #{duration}</if>
            <if test="idNo != null  and idNo != ''"> and id_no = #{idNo}</if>
        </where>
        order by p.duration desc,p.id_no
    </select>

    <select id="selectPsCalculationResult" parameterType="PsCalculationResult" resultMap="PsCalculationResultResult">
        <include refid="selectPsCalculationResultVo"/>
        <where>
            <if test="duration != null and duration != ''"> and duration = #{duration}</if>
            <if test="idNo != null  and idNo != ''"> and id_no = #{idNo}</if>
        </where>
        order by p.duration desc,p.id_no
    </select>

    <insert id="insertPsCalculationResult" parameterType="PsCalculationResult" useGeneratedKeys="true" keyProperty="id">
        insert into ps_calculation_result
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="duration != null">duration,</if>
            <if test="idNo != null">id_no,</if>
            <if test="name != null">name,</if>
            <if test="basicSalary != null">basic_salary,</if>
            <if test="floatingSalary != null">floating_salary,</if>
            <if test="monthlyAward != null">monthly_award,</if>
            <if test="quarterAward != null">quarter_award,</if>
            <if test="overtimeAward150 != null">overtime_award_150,</if>
            <if test="overtimeAward200 != null">overtime_award_200,</if>
            <if test="overtimeAward300 != null">overtime_award_300,</if>
            <if test="ealaDeduction != null">eala_deduction,</if>
            <if test="alDeduction != null">al_deduction,</if>
            <if test="absenteeismDeduction != null">absenteeism_deduction,</if>
            <if test="slDeduction != null">sl_deduction,</if>
            <if test="transportationPayment != null">transportation_payment,</if>
            <if test="communicationPayment != null">communication_payment,</if>
            <if test="mealAllowance != null">meal_allowance,</if>
            <if test="birthdayGift != null">birthday_gift,</if>
            <if test="otherBenefits != null">other_benefits,</if>
            <if test="middleShiftPayment != null">middle_shift_payment,</if>
            <if test="nightShiftPayment != null">night_shift_payment,</if>
            <if test="highTemperaturePayment != null">high_temperature_payment,</if>
            <if test="hotWorkingPayment != null">hot_working_payment,</if>
            <if test="tahwPayment != null">tahw_payment,</if>
            <if test="reissue != null">reissue,</if>
            <if test="wageDeduction != null">wage_deduction,</if>
            <if test="pension != null">pension,</if>
            <if test="medical != null">medical,</if>
            <if test="unemployment != null">unemployment,</if>
            <if test="housingFund != null">housing_fund,</if>
            <if test="steHousingFund != null">ste_housing_fund,</if>
            <if test="socialBenefitsAdjustment != null">social_benefits_adjustment,</if>
            <if test="housingFundAdjustment != null">housing_fund_adjustment,</if>
            <if test="annuity != null">annuity,</if>
            <if test="unionFee != null">union_fee,</if>
            <if test="taxCalculation != null">tax_calculation,</if>
            <if test="preTaxIncome != null">pre_tax_income,</if>
            <if test="basicDeduction != null">basic_deduction,</if>
            <if test="accumulatedIpti != null">accumulated_ipti,</if>
            <if test="accumulatedIsiahf != null">accumulated_isiahf,</if>
            <if test="accumulatedBd != null">accumulated_bd,</if>
            <if test="accumulatedChildEducation != null">accumulated_child_education,</if>
            <if test="accumulatedContinuingEducation != null">accumulated_continuing_education,</if>
            <if test="accumulatedHli != null">accumulated_hli,</if>
            <if test="accumulatedHousingRent != null">accumulated_housing_rent,</if>
            <if test="accumulatedSfte != null">accumulated_sfte,</if>
            <if test="accumulatedOther != null">accumulated_other,</if>
            <if test="accumulatedTftd != null">accumulated_tftd,</if>
            <if test="accumulatedTotalCost != null">accumulated_total_cost,</if>
            <if test="accumulatedIl != null">accumulated_il,</if>
            <if test="individualLlt != null">individual_llt,</if>
            <if test="companyTax != null">company_tax,</if>
            <if test="companyTotalTax != null">company_total_tax,</if>
            <if test="accumulatedAti != null">accumulated_ati,</if>
            <if test="accumulatedBti != null">accumulated_bti,</if>
            <if test="theoreticalIncome != null">theoretical_income,</if>
            <if test="accumulatedLltCai != null">accumulated_llt_cai,</if>
            <if test="companyLlt != null">company_llt,</if>
            <if test="onlyChildAllowance != null">only_child_allowance,</if>
            <if test="snteHousingFund != null">snte_housing_fund,</if>
            <if test="expense != null">expense,</if>
            <if test="expense25 != null">expense_25,</if>
            <if test="fsAllowance != null">fs_allowance,</if>
            <if test="afterTaxReissue != null">after_tax_reissue,</if>
            <if test="afterTaxDeduction != null">after_tax_deduction,</if>
            <if test="annualBonus != null">annual_bonus,</if>
            <if test="annualBonusLlt != null">annual_bonus_llt,</if>
            <if test="income != null">income,</if>
            <if test="cost != null">cost,</if>
            <if test="netIncome != null">net_income,</if>
            <if test="companyPension != null">company_pension,</if>
            <if test="companyMedical != null">company_medical,</if>
            <if test="companyUnemployment != null">company_unemployment,</if>
            <if test="companyMaternity != null">company_maternity,</if>
            <if test="companyWri != null">company_wri,</if>
            <if test="companyDisability != null">company_disability,</if>
            <if test="companyHousingFund != null">company_housing_fund,</if>
            <if test="companyShf != null">company_shf,</if>
            <if test="accumulatedPayrollTax != null">accumulated_payroll_tax,</if>
            <if test="employerLiability != null">employer_liability,</if>
            <if test="deposit != null">deposit,</if>
            <if test="serviceFee != null">service_fee,</if>
            <if test="valueAddedTax != null">value_added_tax,</if>
            <if test="otherBonus != null">other_bonus,</if>
            <if test="pretaxAdjustment != null">pre_tax_adjustment,</if>
            <if test="indemnity != null">indemnity,</if>
            <if test="indemnityTax != null">indemnity_tax,</if>
            <if test="shareIncentives != null">share_incentives,</if>
            <if test="shareIncentivesTax != null">share_incentives_tax,</if>
            <if test="serviceFeeTax != null">service_fee_tax,</if>
            <if test="travelAllowance != null">travel_allowance,</if>
            <if test="accumulatedChildCare != null">accumulated_child_care,</if>
            <if test="groupIds != null and groupIds !=''">group_ids,</if>
            <if test="createBy != null and createBy != ''">create_by,</if>
            create_time
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="duration != null">#{duration},</if>
            <if test="idNo != null">#{idNo},</if>
            <if test="name != null">#{name},</if>
            <if test="basicSalary != null">#{basicSalary},</if>
            <if test="floatingSalary != null">#{floatingSalary},</if>
            <if test="monthlyAward != null">#{monthlyAward},</if>
            <if test="quarterAward != null">#{quarterAward},</if>
            <if test="overtimeAward150 != null">#{overtimeAward150},</if>
            <if test="overtimeAward200 != null">#{overtimeAward200},</if>
            <if test="overtimeAward300 != null">#{overtimeAward300},</if>
            <if test="ealaDeduction != null">#{ealaDeduction},</if>
            <if test="alDeduction != null">#{alDeduction},</if>
            <if test="absenteeismDeduction != null">#{absenteeismDeduction},</if>
            <if test="slDeduction != null">#{slDeduction},</if>
            <if test="transportationPayment != null">#{transportationPayment},</if>
            <if test="communicationPayment != null">#{communicationPayment},</if>
            <if test="mealAllowance != null">#{mealAllowance},</if>
            <if test="birthdayGift != null">#{birthdayGift},</if>
            <if test="otherBenefits != null">#{otherBenefits},</if>
            <if test="middleShiftPayment != null">#{middleShiftPayment},</if>
            <if test="nightShiftPayment != null">#{nightShiftPayment},</if>
            <if test="highTemperaturePayment != null">#{highTemperaturePayment},</if>
            <if test="hotWorkingPayment != null">#{hotWorkingPayment},</if>
            <if test="tahwPayment != null">#{tahwPayment},</if>
            <if test="reissue != null">#{reissue},</if>
            <if test="wageDeduction != null">#{wageDeduction},</if>
            <if test="pension != null">#{pension},</if>
            <if test="medical != null">#{medical},</if>
            <if test="unemployment != null">#{unemployment},</if>
            <if test="housingFund != null">#{housingFund},</if>
            <if test="steHousingFund != null">#{steHousingFund},</if>
            <if test="socialBenefitsAdjustment != null">#{socialBenefitsAdjustment},</if>
            <if test="housingFundAdjustment != null">#{housingFundAdjustment},</if>
            <if test="annuity != null">#{annuity},</if>
            <if test="unionFee != null">#{unionFee},</if>
            <if test="taxCalculation != null">#{taxCalculation},</if>
            <if test="preTaxIncome != null">#{preTaxIncome},</if>
            <if test="basicDeduction != null">#{basicDeduction},</if>
            <if test="accumulatedIpti != null">#{accumulatedIpti},</if>
            <if test="accumulatedIsiahf != null">#{accumulatedIsiahf},</if>
            <if test="accumulatedBd != null">#{accumulatedBd},</if>
            <if test="accumulatedChildEducation != null">#{accumulatedChildEducation},</if>
            <if test="accumulatedContinuingEducation != null">#{accumulatedContinuingEducation},</if>
            <if test="accumulatedHli != null">#{accumulatedHli},</if>
            <if test="accumulatedHousingRent != null">#{accumulatedHousingRent},</if>
            <if test="accumulatedSfte != null">#{accumulatedSfte},</if>
            <if test="accumulatedOther != null">#{accumulatedOther},</if>
            <if test="accumulatedTftd != null">#{accumulatedTftd},</if>
            <if test="accumulatedTotalCost != null">#{accumulatedTotalCost},</if>
            <if test="accumulatedIl != null">#{accumulatedIl},</if>
            <if test="individualLlt != null">#{individualLlt},</if>
            <if test="companyTax != null">#{companyTax},</if>
            <if test="companyTotalTax != null">#{companyTotalTax},</if>
            <if test="accumulatedAti != null">#{accumulatedAti},</if>
            <if test="accumulatedBti != null">#{accumulatedBti},</if>
            <if test="theoreticalIncome != null">#{theoreticalIncome},</if>
            <if test="accumulatedLltCai != null">#{accumulatedLltCai},</if>
            <if test="companyLlt != null">#{companyLlt},</if>
            <if test="onlyChildAllowance != null">#{onlyChildAllowance},</if>
            <if test="snteHousingFund != null">#{snteHousingFund},</if>
            <if test="expense != null">#{expense},</if>
            <if test="expense25 != null">#{expense25},</if>
            <if test="fsAllowance != null">#{fsAllowance},</if>
            <if test="afterTaxReissue != null">#{afterTaxReissue},</if>
            <if test="afterTaxDeduction != null">#{afterTaxDeduction},</if>
            <if test="annualBonus != null">#{annualBonus},</if>
            <if test="annualBonusLlt != null">#{annualBonusLlt},</if>
            <if test="income != null">#{income},</if>
            <if test="cost != null">#{cost},</if>
            <if test="netIncome != null">#{netIncome},</if>
            <if test="companyPension != null">#{companyPension},</if>
            <if test="companyMedical != null">#{companyMedical},</if>
            <if test="companyUnemployment != null">#{companyUnemployment},</if>
            <if test="companyMaternity != null">#{companyMaternity},</if>
            <if test="companyWri != null">#{companyWri},</if>
            <if test="companyDisability != null">#{companyDisability},</if>
            <if test="companyHousingFund != null">#{companyHousingFund},</if>
            <if test="companyShf != null">#{companyShf},</if>
            <if test="accumulatedPayrollTax != null">#{accumulatedPayrollTax},</if>
            <if test="employerLiability != null">#{employerLiability},</if>
            <if test="deposit != null">#{deposit},</if>
            <if test="serviceFee != null">#{serviceFee},</if>
            <if test="valueAddedTax != null">#{valueAddedTax},</if>
            <if test="otherBonus != null">#{otherBonus},</if>
            <if test="pretaxAdjustment != null">#{pretaxAdjustment},</if>
            <if test="indemnity != null">#{indemnity},</if>
            <if test="indemnityTax != null">#{indemnityTax},</if>
            <if test="shareIncentives != null">#{shareIncentives},</if>
            <if test="shareIncentivesTax != null">#{shareIncentivesTax},</if>
            <if test="serviceFeeTax != null">#{serviceFeeTax},</if>
            <if test="travelAllowance != null">#{travelAllowance},</if>
            <if test="accumulatedChildCare != null">#{accumulatedChildCare},</if>
            <if test="groupIds != null and groupIds !=''">#{groupIds},</if>
            <if test="createBy != null and createBy != ''">#{createBy},</if>
            sysdate()
        </trim>
    </insert>

    <update id="updatePsCalculationResult" parameterType="PsCalculationResult">
        update ps_calculation_result
        <trim prefix="SET" suffixOverrides=",">
            <if test="duration != null">duration = #{duration},</if>
            <if test="idNo != null">id_no = #{idNo},</if>
            <if test="name != null">name = #{name},</if>
            <if test="basicSalary != null">basic_salary = #{basicSalary},</if>
            <if test="floatingSalary != null">floating_salary = #{floatingSalary},</if>
            <if test="monthlyAward != null">monthly_award = #{monthlyAward},</if>
            <if test="quarterAward != null">quarter_award = #{quarterAward},</if>
            <if test="overtimeAward150 != null">overtime_award_150 = #{overtimeAward150},</if>
            <if test="overtimeAward200 != null">overtime_award_200 = #{overtimeAward200},</if>
            <if test="overtimeAward300 != null">overtime_award_300 = #{overtimeAward300},</if>
            <if test="ealaDeduction != null">eala_deduction = #{ealaDeduction},</if>
            <if test="alDeduction != null">al_deduction = #{alDeduction},</if>
            <if test="absenteeismDeduction != null">absenteeism_deduction = #{absenteeismDeduction},</if>
            <if test="slDeduction != null">sl_deduction = #{slDeduction},</if>
            <if test="transportationPayment != null">transportation_payment = #{transportationPayment},</if>
            <if test="communicationPayment != null">communication_payment = #{communicationPayment},</if>
            <if test="mealAllowance != null">meal_allowance = #{mealAllowance},</if>
            <if test="birthdayGift != null">birthday_gift = #{birthdayGift},</if>
            <if test="otherBenefits != null">other_benefits = #{otherBenefits},</if>
            <if test="middleShiftPayment != null">middle_shift_payment = #{middleShiftPayment},</if>
            <if test="nightShiftPayment != null">night_shift_payment = #{nightShiftPayment},</if>
            <if test="highTemperaturePayment != null">high_temperature_payment = #{highTemperaturePayment},</if>
            <if test="hotWorkingPayment != null">hot_working_payment = #{hotWorkingPayment},</if>
            <if test="tahwPayment != null">tahw_payment = #{tahwPayment},</if>
            <if test="reissue != null">reissue = #{reissue},</if>
            <if test="wageDeduction != null">wage_deduction = #{wageDeduction},</if>
            <if test="pension != null">pension = #{pension},</if>
            <if test="medical != null">medical = #{medical},</if>
            <if test="unemployment != null">unemployment = #{unemployment},</if>
            <if test="housingFund != null">housing_fund = #{housingFund},</if>
            <if test="steHousingFund != null">ste_housing_fund = #{steHousingFund},</if>
            <if test="socialBenefitsAdjustment != null">social_benefits_adjustment = #{socialBenefitsAdjustment},</if>
            <if test="housingFundAdjustment != null">housing_fund_adjustment = #{housingFundAdjustment},</if>
            <if test="annuity != null">annuity = #{annuity},</if>
            <if test="unionFee != null">union_fee = #{unionFee},</if>
            <if test="taxCalculation != null">tax_calculation = #{taxCalculation},</if>
            <if test="preTaxIncome != null">pre_tax_income = #{preTaxIncome},</if>
            <if test="basicDeduction != null">basic_deduction = #{basicDeduction},</if>
            <if test="accumulatedIpti != null">accumulated_ipti = #{accumulatedIpti},</if>
            <if test="accumulatedIsiahf != null">accumulated_isiahf = #{accumulatedIsiahf},</if>
            <if test="accumulatedBd != null">accumulated_bd = #{accumulatedBd},</if>
            <if test="accumulatedChildEducation != null">accumulated_child_education = #{accumulatedChildEducation},</if>
            <if test="accumulatedContinuingEducation != null">accumulated_continuing_education = #{accumulatedContinuingEducation},</if>
            <if test="accumulatedHli != null">accumulated_hli = #{accumulatedHli},</if>
            <if test="accumulatedHousingRent != null">accumulated_housing_rent = #{accumulatedHousingRent},</if>
            <if test="accumulatedSfte != null">accumulated_sfte = #{accumulatedSfte},</if>
            <if test="accumulatedOther != null">accumulated_other = #{accumulatedOther},</if>
            <if test="accumulatedTftd != null">accumulated_tftd = #{accumulatedTftd},</if>
            <if test="accumulatedTotalCost != null">accumulated_total_cost = #{accumulatedTotalCost},</if>
            <if test="accumulatedIl != null">accumulated_il = #{accumulatedIl},</if>
            <if test="individualLlt != null">individual_llt = #{individualLlt},</if>
            <if test="companyTax != null">company_tax = #{companyTax},</if>
            <if test="companyTotalTax != null">company_total_tax = #{companyTotalTax},</if>
            <if test="accumulatedAti != null">accumulated_ati = #{accumulatedAti},</if>
            <if test="accumulatedBti != null">accumulated_bti = #{accumulatedBti},</if>
            <if test="theoreticalIncome != null">theoretical_income = #{theoreticalIncome},</if>
            <if test="accumulatedLltCai != null">accumulated_llt_cai = #{accumulatedLltCai},</if>
            <if test="companyLlt != null">company_llt = #{companyLlt},</if>
            <if test="onlyChildAllowance != null">only_child_allowance = #{onlyChildAllowance},</if>
            <if test="snteHousingFund != null">snte_housing_fund = #{snteHousingFund},</if>
            <if test="expense != null">expense = #{expense},</if>
            <if test="expense25 != null">expense_25 = #{expense25},</if>
            <if test="fsAllowance != null">fs_allowance = #{fsAllowance},</if>
            <if test="afterTaxReissue != null">after_tax_reissue = #{afterTaxReissue},</if>
            <if test="afterTaxDeduction != null">after_tax_deduction = #{afterTaxDeduction},</if>
            <if test="annualBonus != null">annual_bonus = #{annualBonus},</if>
            <if test="annualBonusLlt != null">annual_bonus_llt = #{annualBonusLlt},</if>
            <if test="income != null">income = #{income},</if>
            <if test="cost != null">cost = #{cost},</if>
            <if test="netIncome != null">net_income = #{netIncome},</if>
            <if test="companyPension != null">company_pension = #{companyPension},</if>
            <if test="companyMedical != null">company_medical = #{companyMedical},</if>
            <if test="companyUnemployment != null">company_unemployment = #{companyUnemployment},</if>
            <if test="companyMaternity != null">company_maternity = #{companyMaternity},</if>
            <if test="companyWri != null">company_wri = #{companyWri},</if>
            <if test="companyDisability != null">company_disability = #{companyDisability},</if>
            <if test="companyHousingFund != null">company_housing_fund = #{companyHousingFund},</if>
            <if test="companyShf != null">company_shf = #{companyShf},</if>
            <if test="accumulatedPayrollTax != null">accumulated_payroll_tax = #{accumulatedPayrollTax},</if>
            <if test="employerLiability != null">employer_liability = #{employerLiability},</if>
            <if test="deposit != null">deposit = #{deposit},</if>
            <if test="serviceFee != null">service_fee = #{serviceFee},</if>
            <if test="valueAddedTax != null">value_added_tax = #{valueAddedTax},</if>
            <if test="otherBonus != null">other_bonus = #{otherBonus},</if>
            <if test="pretaxAdjustment != null">pre_tax_adjustment = #{pretaxAdjustment},</if>
            <if test="indemnity != null">indemnity = #{indemnity},</if>
            <if test="indemnityTax != null">indemnity_tax = #{indemnityTax},</if>
            <if test="shareIncentives != null">share_incentives = #{shareIncentives},</if>
            <if test="shareIncentivesTax != null">share_incentives_tax = #{shareIncentivesTax},</if>
            <if test="serviceFeeTax != null">service_fee_tax = #{serviceFeeTax},</if>
            <if test="travelAllowance != null">travel_allowance = #{travelAllowance},</if>
            <if test="accumulatedChildCare != null">accumulated_child_care = #{accumulatedChildCare},</if>
            <if test="groupIds != null and groupIds !=''">group_ids = #{groupIds},</if>
            <if test="updateBy != null and updateBy != ''">update_by = #{updateBy},</if>
            update_time = sysdate()
        </trim>
        where id_no = #{idNo} and duration = #{duration}
    </update>


    <select id="selectPsPayrollList" parameterType="PsPayroll" resultMap="PsPayrollResult">
        <include refid="selectPsPayrollVo"/>
        <where>
            <if test="department != null  and department != ''"> and department = #{department}</if>
            <if test="duration != null  and duration != ''"> and duration = #{duration}</if>
            <if test="idNo != null  and idNo != ''"> and id_no = #{idNo}</if>
            <if test="name != null  and name != ''"> and name like concat('%', #{name}, '%')</if>
            <if test="netIncome != null "> and net_income = #{netIncome}</if>
            <if test="expense != null "> and expense = #{expense}</if>
            <if test="foreignerAllowance != null "> and foreigner_allowance = #{foreignerAllowance}</if>
            <if test="ipPension != null "> and ip_pension = #{ipPension}</if>
            <if test="ipMedical != null "> and ip_medical = #{ipMedical}</if>
            <if test="ipUnemployment != null "> and ip_unemployment = #{ipUnemployment}</if>
            <if test="ipHousingFund != null "> and ip_housing_fund = #{ipHousingFund}</if>
            <if test="ipAnnuity != null "> and ip_annuity = #{ipAnnuity}</if>
            <if test="ipUnionFee != null "> and ip_union_fee = #{ipUnionFee}</if>
            <if test="IIT != null "> and IIT = #{IIT}</if>
            <if test="balanceCharge != null "> and balance_charge = #{balanceCharge}</if>
            <if test="epPension != null "> and ep_pension = #{epPension}</if>
            <if test="epMedical != null "> and ep_medical = #{epMedical}</if>
            <if test="epUnemployment != null "> and ep_unemployment = #{epUnemployment}</if>
            <if test="maternity != null "> and maternity = #{maternity}</if>
            <if test="workRelatedInjury != null "> and work_related_Injury = #{workRelatedInjury}</if>
            <if test="disability != null "> and disability = #{disability}</if>
            <if test="epHousingFund != null "> and ep_housing_fund = #{epHousingFund}</if>
            <if test="epAnnuity != null "> and ep_annuity = #{epAnnuity}</if>
            <if test="epUnionFee != null "> and ep_union_fee = #{epUnionFee}</if>
            <if test="epHeatingFee != null "> and ep_heating_fee = #{epHeatingFee}</if>
            <if test="commercialInsurance != null "> and commercial_insurance = #{commercialInsurance}</if>
            <if test="otherBenefits != null "> and other_benefits = #{otherBenefits}</if>
            <if test="serviceFee != null "> and service_fee = #{serviceFee}</if>
            <if test="businessTax != null "> and business_tax = #{businessTax}</if>
            <if test="deposit != null "> and deposit = #{deposit}</if>
            <if test="employerLiability != null "> and employer_liability = #{employerLiability}</if>
            <if test="officeSeat != null "> and office_seat = #{officeSeat}</if>
            <if test="serviceFeeTax != null "> and service_fee_tax = #{serviceFeeTax}</if>
            <if test="valueAddedTax != null "> and value_added_tax = #{valueAddedTax}</if>
            <if test="totalCost != null "> and total_cost = #{totalCost}</if>
        </where>
        order by duration desc,id_no
    </select>

    <select id="selectPsPayrollList" parameterType="PsPayroll" resultMap="PsPayrollResult">
        <include refid="selectPsPayrollVo"/>
        <where>
            <if test="department != null  and department != ''"> and department = #{department}</if>
            <if test="duration != null  and duration != ''"> and duration = #{duration}</if>
            <if test="idNo != null  and idNo != ''"> and id_no = #{idNo}</if>
            <if test="name != null  and name != ''"> and name like concat('%', #{name}, '%')</if>
            <if test="netIncome != null "> and net_income = #{netIncome}</if>
            <if test="expense != null "> and expense = #{expense}</if>
            <if test="foreignerAllowance != null "> and foreigner_allowance = #{foreignerAllowance}</if>
            <if test="ipPension != null "> and ip_pension = #{ipPension}</if>
            <if test="ipMedical != null "> and ip_medical = #{ipMedical}</if>
            <if test="ipUnemployment != null "> and ip_unemployment = #{ipUnemployment}</if>
            <if test="ipHousingFund != null "> and ip_housing_fund = #{ipHousingFund}</if>
            <if test="ipAnnuity != null "> and ip_annuity = #{ipAnnuity}</if>
            <if test="ipUnionFee != null "> and ip_union_fee = #{ipUnionFee}</if>
            <if test="IIT != null "> and IIT = #{IIT}</if>
            <if test="balanceCharge != null "> and balance_charge = #{balanceCharge}</if>
            <if test="epPension != null "> and ep_pension = #{epPension}</if>
            <if test="epMedical != null "> and ep_medical = #{epMedical}</if>
            <if test="epUnemployment != null "> and ep_unemployment = #{epUnemployment}</if>
            <if test="maternity != null "> and maternity = #{maternity}</if>
            <if test="workRelatedInjury != null "> and work_related_Injury = #{workRelatedInjury}</if>
            <if test="disability != null "> and disability = #{disability}</if>
            <if test="epHousingFund != null "> and ep_housing_fund = #{epHousingFund}</if>
            <if test="epAnnuity != null "> and ep_annuity = #{epAnnuity}</if>
            <if test="epUnionFee != null "> and ep_union_fee = #{epUnionFee}</if>
            <if test="epHeatingFee != null "> and ep_heating_fee = #{epHeatingFee}</if>
            <if test="commercialInsurance != null "> and commercial_insurance = #{commercialInsurance}</if>
            <if test="otherBenefits != null "> and other_benefits = #{otherBenefits}</if>
            <if test="serviceFee != null "> and service_fee = #{serviceFee}</if>
            <if test="businessTax != null "> and business_tax = #{businessTax}</if>
            <if test="deposit != null "> and deposit = #{deposit}</if>
            <if test="employerLiability != null "> and employer_liability = #{employerLiability}</if>
            <if test="officeSeat != null "> and office_seat = #{officeSeat}</if>
            <if test="serviceFeeTax != null "> and service_fee_tax = #{serviceFeeTax}</if>
            <if test="valueAddedTax != null "> and value_added_tax = #{valueAddedTax}</if>
            <if test="totalCost != null "> and total_cost = #{totalCost}</if>
        </where>
        order by duration desc,id_no
    </select>

    <select id="selectPsPayroll" parameterType="PsPayroll" resultMap="PsPayrollResult">
        <include refid="selectPsPayrollVo"/>
        <where>
            <if test="department != null  and department != ''"> and department = #{department}</if>
            <if test="duration != null  and duration != ''"> and duration = #{duration}</if>
            <if test="idNo != null  and idNo != ''"> and id_no = #{idNo}</if>
            <if test="name != null  and name != ''"> and name like concat('%', #{name}, '%')</if>
            <if test="netIncome != null "> and net_income = #{netIncome}</if>
            <if test="expense != null "> and expense = #{expense}</if>
            <if test="foreignerAllowance != null "> and foreigner_allowance = #{foreignerAllowance}</if>
            <if test="ipPension != null "> and ip_pension = #{ipPension}</if>
            <if test="ipMedical != null "> and ip_medical = #{ipMedical}</if>
            <if test="ipUnemployment != null "> and ip_unemployment = #{ipUnemployment}</if>
            <if test="ipHousingFund != null "> and ip_housing_fund = #{ipHousingFund}</if>
            <if test="ipAnnuity != null "> and ip_annuity = #{ipAnnuity}</if>
            <if test="ipUnionFee != null "> and ip_union_fee = #{ipUnionFee}</if>
            <if test="IIT != null "> and IIT = #{IIT}</if>
            <if test="balanceCharge != null "> and balance_charge = #{balanceCharge}</if>
            <if test="epPension != null "> and ep_pension = #{epPension}</if>
            <if test="epMedical != null "> and ep_medical = #{epMedical}</if>
            <if test="epUnemployment != null "> and ep_unemployment = #{epUnemployment}</if>
            <if test="maternity != null "> and maternity = #{maternity}</if>
            <if test="workRelatedInjury != null "> and work_related_Injury = #{workRelatedInjury}</if>
            <if test="disability != null "> and disability = #{disability}</if>
            <if test="epHousingFund != null "> and ep_housing_fund = #{epHousingFund}</if>
            <if test="epAnnuity != null "> and ep_annuity = #{epAnnuity}</if>
            <if test="epUnionFee != null "> and ep_union_fee = #{epUnionFee}</if>
            <if test="epHeatingFee != null "> and ep_heating_fee = #{epHeatingFee}</if>
            <if test="commercialInsurance != null "> and commercial_insurance = #{commercialInsurance}</if>
            <if test="otherBenefits != null "> and other_benefits = #{otherBenefits}</if>
            <if test="serviceFee != null "> and service_fee = #{serviceFee}</if>
            <if test="businessTax != null "> and business_tax = #{businessTax}</if>
            <if test="deposit != null "> and deposit = #{deposit}</if>
            <if test="employerLiability != null "> and employer_liability = #{employerLiability}</if>
            <if test="officeSeat != null "> and office_seat = #{officeSeat}</if>
            <if test="serviceFeeTax != null "> and service_fee_tax = #{serviceFeeTax}</if>
            <if test="valueAddedTax != null "> and value_added_tax = #{valueAddedTax}</if>
            <if test="totalCost != null "> and total_cost = #{totalCost}</if>
        </where>
        order by duration desc,id_no
    </select>

    <select id="selectVendorPsPayroll" parameterType="PsPayroll" resultMap="PsPayrollResult">
        <include refid="selectVendorPsPayrollVo"/>
        <where>
            <if test="department != null  and department != ''"> and department = #{department}</if>
            <if test="duration != null  and duration != ''"> and duration = #{duration}</if>
            <if test="idNo != null  and idNo != ''"> and id_no = #{idNo}</if>
            <if test="name != null  and name != ''"> and name like concat('%', #{name}, '%')</if>
            <if test="netIncome != null "> and net_income = #{netIncome}</if>
            <if test="expense != null "> and expense = #{expense}</if>
            <if test="foreignerAllowance != null "> and foreigner_allowance = #{foreignerAllowance}</if>
            <if test="ipPension != null "> and ip_pension = #{ipPension}</if>
            <if test="ipMedical != null "> and ip_medical = #{ipMedical}</if>
            <if test="ipUnemployment != null "> and ip_unemployment = #{ipUnemployment}</if>
            <if test="ipHousingFund != null "> and ip_housing_fund = #{ipHousingFund}</if>
            <if test="ipAnnuity != null "> and ip_annuity = #{ipAnnuity}</if>
            <if test="ipUnionFee != null "> and ip_union_fee = #{ipUnionFee}</if>
            <if test="IIT != null "> and IIT = #{IIT}</if>
            <if test="balanceCharge != null "> and balance_charge = #{balanceCharge}</if>
            <if test="epPension != null "> and ep_pension = #{epPension}</if>
            <if test="epMedical != null "> and ep_medical = #{epMedical}</if>
            <if test="epUnemployment != null "> and ep_unemployment = #{epUnemployment}</if>
            <if test="maternity != null "> and maternity = #{maternity}</if>
            <if test="workRelatedInjury != null "> and work_related_Injury = #{workRelatedInjury}</if>
            <if test="disability != null "> and disability = #{disability}</if>
            <if test="epHousingFund != null "> and ep_housing_fund = #{epHousingFund}</if>
            <if test="epAnnuity != null "> and ep_annuity = #{epAnnuity}</if>
            <if test="epUnionFee != null "> and ep_union_fee = #{epUnionFee}</if>
            <if test="epHeatingFee != null "> and ep_heating_fee = #{epHeatingFee}</if>
            <if test="commercialInsurance != null "> and commercial_insurance = #{commercialInsurance}</if>
            <if test="otherBenefits != null "> and other_benefits = #{otherBenefits}</if>
            <if test="serviceFee != null "> and service_fee = #{serviceFee}</if>
            <if test="businessTax != null "> and business_tax = #{businessTax}</if>
            <if test="deposit != null "> and deposit = #{deposit}</if>
            <if test="employerLiability != null "> and employer_liability = #{employerLiability}</if>
            <if test="officeSeat != null "> and office_seat = #{officeSeat}</if>
            <if test="serviceFeeTax != null "> and service_fee_tax = #{serviceFeeTax}</if>
            <if test="valueAddedTax != null "> and value_added_tax = #{valueAddedTax}</if>
            <if test="totalCost != null "> and total_cost = #{totalCost}</if>
        </where>
        order by duration desc,id_no
    </select>

    <insert id="insertPsPayroll" parameterType="PsPayroll" useGeneratedKeys="true" keyProperty="id">
        insert into ps_payroll
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="department != null">department,</if>
            <if test="duration != null">duration,</if>
            <if test="idNo != null">id_no,</if>
            <if test="name != null">name,</if>
            <if test="netIncome != null">net_income,</if>
            <if test="expense != null">expense,</if>
            <if test="foreignerAllowance != null">foreigner_allowance,</if>
            <if test="ipPension != null">ip_pension,</if>
            <if test="ipMedical != null">ip_medical,</if>
            <if test="ipUnemployment != null">ip_unemployment,</if>
            <if test="ipHousingFund != null">ip_housing_fund,</if>
            <if test="ipAnnuity != null">ip_annuity,</if>
            <if test="ipUnionFee != null">ip_union_fee,</if>
            <if test="IIT != null">IIT,</if>
            <if test="balanceCharge != null">balance_charge,</if>
            <if test="epPension != null">ep_pension,</if>
            <if test="epMedical != null">ep_medical,</if>
            <if test="epUnemployment != null">ep_unemployment,</if>
            <if test="maternity != null">maternity,</if>
            <if test="workRelatedInjury != null">work_related_Injury,</if>
            <if test="disability != null">disability,</if>
            <if test="epHousingFund != null">ep_housing_fund,</if>
            <if test="epAnnuity != null">ep_annuity,</if>
            <if test="epUnionFee != null">ep_union_fee,</if>
            <if test="epHeatingFee != null">ep_heating_fee,</if>
            <if test="commercialInsurance != null">commercial_insurance,</if>
            <if test="otherBenefits != null">other_benefits,</if>
            <if test="serviceFee != null">service_fee,</if>
            <if test="businessTax != null">business_tax,</if>
            <if test="deposit != null">deposit,</if>
            <if test="employerLiability != null">employer_liability,</if>
            <if test="officeSeat != null">office_seat,</if>
            <if test="others != null">others,</if>
            <if test="serviceFeeTax != null ">service_fee_tax,</if>
            <if test="valueAddedTax != null">value_added_tax,</if>
            <if test="totalCost != null">total_cost,</if>
            <if test="taxFreeItem != null">tax_free_item,</if>
            <if test="remarks != null">remarks,</if>
            <if test="groupIds != null and groupIds !=''">group_ids,</if>
            <if test="payrollSource != null and payrollSource !=''">payroll_source,</if>
            <if test="createBy != null and createBy != ''">create_by,</if>
            create_time
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="department != null">#{department},</if>
            <if test="duration != null">#{duration},</if>
            <if test="idNo != null">#{idNo},</if>
            <if test="name != null">#{name},</if>
            <if test="netIncome != null">#{netIncome},</if>
            <if test="expense != null">#{expense},</if>
            <if test="foreignerAllowance != null">#{foreignerAllowance},</if>
            <if test="ipPension != null">#{ipPension},</if>
            <if test="ipMedical != null">#{ipMedical},</if>
            <if test="ipUnemployment != null">#{ipUnemployment},</if>
            <if test="ipHousingFund != null">#{ipHousingFund},</if>
            <if test="ipAnnuity != null">#{ipAnnuity},</if>
            <if test="ipUnionFee != null">#{ipUnionFee},</if>
            <if test="IIT != null">#{IIT},</if>
            <if test="balanceCharge != null">#{balanceCharge},</if>
            <if test="epPension != null">#{epPension},</if>
            <if test="epMedical != null">#{epMedical},</if>
            <if test="epUnemployment != null">#{epUnemployment},</if>
            <if test="maternity != null">#{maternity},</if>
            <if test="workRelatedInjury != null">#{workRelatedInjury},</if>
            <if test="disability != null">#{disability},</if>
            <if test="epHousingFund != null">#{epHousingFund},</if>
            <if test="epAnnuity != null">#{epAnnuity},</if>
            <if test="epUnionFee != null">#{epUnionFee},</if>
            <if test="epHeatingFee != null">#{epHeatingFee},</if>
            <if test="commercialInsurance != null">#{commercialInsurance},</if>
            <if test="otherBenefits != null">#{otherBenefits},</if>
            <if test="serviceFee != null">#{serviceFee},</if>
            <if test="businessTax != null">#{businessTax},</if>
            <if test="deposit != null">#{deposit},</if>
            <if test="employerLiability != null">#{employerLiability},</if>
            <if test="officeSeat != null">#{officeSeat},</if>
            <if test="others != null">#{others},</if>
            <if test="serviceFeeTax != null ">#{serviceFeeTax},</if>
            <if test="valueAddedTax != null">#{valueAddedTax},</if>
            <if test="totalCost != null">#{totalCost},</if>
            <if test="taxFreeItem != null">#{taxFreeItem},</if>
            <if test="remarks != null">#{remarks},</if>
            <if test="groupIds != null and groupIds !=''">#{groupIds},</if>
            <if test="payrollSource !=null">#{payrollSource},</if>
            <if test="createBy != null and createBy != ''">#{createBy},</if>
            sysdate()
        </trim>
    </insert>

    <insert id="insertVendorPsPayroll" parameterType="PsPayroll" useGeneratedKeys="true" keyProperty="id">
        insert into vendor_ps_payroll
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="department != null">department,</if>
            <if test="duration != null">duration,</if>
            <if test="idNo != null">id_no,</if>
            <if test="name != null">name,</if>
            <if test="netIncome != null">net_income,</if>
            <if test="expense != null">expense,</if>
            <if test="foreignerAllowance != null">foreigner_allowance,</if>
            <if test="ipPension != null">ip_pension,</if>
            <if test="ipMedical != null">ip_medical,</if>
            <if test="ipUnemployment != null">ip_unemployment,</if>
            <if test="ipHousingFund != null">ip_housing_fund,</if>
            <if test="ipAnnuity != null">ip_annuity,</if>
            <if test="ipUnionFee != null">ip_union_fee,</if>
            <if test="IIT != null">IIT,</if>
            <if test="balanceCharge != null">balance_charge,</if>
            <if test="epPension != null">ep_pension,</if>
            <if test="epMedical != null">ep_medical,</if>
            <if test="epUnemployment != null">ep_unemployment,</if>
            <if test="maternity != null">maternity,</if>
            <if test="workRelatedInjury != null">work_related_Injury,</if>
            <if test="disability != null">disability,</if>
            <if test="epHousingFund != null">ep_housing_fund,</if>
            <if test="epAnnuity != null">ep_annuity,</if>
            <if test="epUnionFee != null">ep_union_fee,</if>
            <if test="epHeatingFee != null">ep_heating_fee,</if>
            <if test="commercialInsurance != null">commercial_insurance,</if>
            <if test="otherBenefits != null">other_benefits,</if>
            <if test="serviceFee != null">service_fee,</if>
            <if test="businessTax != null">business_tax,</if>
            <if test="deposit != null">deposit,</if>
            <if test="employerLiability != null">employer_liability,</if>
            <if test="officeSeat != null">office_seat,</if>
            <if test="others != null">others,</if>
            <if test="serviceFeeTax != null ">service_fee_tax,</if>
            <if test="valueAddedTax != null">value_added_tax,</if>
            <if test="totalCost != null">total_cost,</if>
            <if test="taxFreeItem != null">tax_free_item,</if>
            <if test="remarks != null">remarks,</if>
            <if test="groupIds != null and groupIds !=''">group_ids,</if>
            <if test="payrollSource != null and payrollSource !=''">payroll_source,</if>
            <if test="createBy != null and createBy != ''">create_by,</if>
            create_time
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="department != null">#{department},</if>
            <if test="duration != null">#{duration},</if>
            <if test="idNo != null">#{idNo},</if>
            <if test="name != null">#{name},</if>
            <if test="netIncome != null">#{netIncome},</if>
            <if test="expense != null">#{expense},</if>
            <if test="foreignerAllowance != null">#{foreignerAllowance},</if>
            <if test="ipPension != null">#{ipPension},</if>
            <if test="ipMedical != null">#{ipMedical},</if>
            <if test="ipUnemployment != null">#{ipUnemployment},</if>
            <if test="ipHousingFund != null">#{ipHousingFund},</if>
            <if test="ipAnnuity != null">#{ipAnnuity},</if>
            <if test="ipUnionFee != null">#{ipUnionFee},</if>
            <if test="IIT != null">#{IIT},</if>
            <if test="balanceCharge != null">#{balanceCharge},</if>
            <if test="epPension != null">#{epPension},</if>
            <if test="epMedical != null">#{epMedical},</if>
            <if test="epUnemployment != null">#{epUnemployment},</if>
            <if test="maternity != null">#{maternity},</if>
            <if test="workRelatedInjury != null">#{workRelatedInjury},</if>
            <if test="disability != null">#{disability},</if>
            <if test="epHousingFund != null">#{epHousingFund},</if>
            <if test="epAnnuity != null">#{epAnnuity},</if>
            <if test="epUnionFee != null">#{epUnionFee},</if>
            <if test="epHeatingFee != null">#{epHeatingFee},</if>
            <if test="commercialInsurance != null">#{commercialInsurance},</if>
            <if test="otherBenefits != null">#{otherBenefits},</if>
            <if test="serviceFee != null">#{serviceFee},</if>
            <if test="businessTax != null">#{businessTax},</if>
            <if test="deposit != null">#{deposit},</if>
            <if test="employerLiability != null">#{employerLiability},</if>
            <if test="officeSeat != null">#{officeSeat},</if>
            <if test="others != null">#{others},</if>
            <if test="serviceFeeTax != null ">#{serviceFeeTax},</if>
            <if test="valueAddedTax != null">#{valueAddedTax},</if>
            <if test="totalCost != null">#{totalCost},</if>
            <if test="taxFreeItem != null">#{taxFreeItem},</if>
            <if test="remarks != null">#{remarks},</if>
            <if test="groupIds != null and groupIds !=''">#{groupIds},</if>
            <if test="payrollSource !=null">#{payrollSource},</if>
            <if test="createBy != null and createBy != ''">#{createBy},</if>
            sysdate()
        </trim>
    </insert>

    <update id="updatePsPayroll" parameterType="PsPayroll">
        update ps_payroll
        <trim prefix="SET" suffixOverrides=",">
            <if test="department != null">department = #{department},</if>
            <if test="duration != null">duration = #{duration},</if>
            <if test="idNo != null">id_no = #{idNo},</if>
            <if test="name != null">name = #{name},</if>
            <if test="netIncome != null">net_income = #{netIncome},</if>
            <if test="expense != null">expense = #{expense},</if>
            <if test="foreignerAllowance != null">foreigner_allowance = #{foreignerAllowance},</if>
            <if test="ipPension != null">ip_pension = #{ipPension},</if>
            <if test="ipMedical != null">ip_medical = #{ipMedical},</if>
            <if test="ipUnemployment != null">ip_unemployment = #{ipUnemployment},</if>
            <if test="ipHousingFund != null">ip_housing_fund = #{ipHousingFund},</if>
            <if test="ipAnnuity != null">ip_annuity = #{ipAnnuity},</if>
            <if test="ipUnionFee != null">ip_union_fee = #{ipUnionFee},</if>
            <if test="IIT != null">IIT = #{IIT},</if>
            <if test="balanceCharge != null">balance_charge = #{balanceCharge},</if>
            <if test="epPension != null">ep_pension = #{epPension},</if>
            <if test="epMedical != null">ep_medical = #{epMedical},</if>
            <if test="epUnemployment != null">ep_unemployment = #{epUnemployment},</if>
            <if test="maternity != null">maternity = #{maternity},</if>
            <if test="workRelatedInjury != null">work_related_Injury = #{workRelatedInjury},</if>
            <if test="disability != null">disability = #{disability},</if>
            <if test="epHousingFund != null">ep_housing_fund = #{epHousingFund},</if>
            <if test="epAnnuity != null">ep_annuity = #{epAnnuity},</if>
            <if test="epUnionFee != null">ep_union_fee = #{epUnionFee},</if>
            <if test="epHeatingFee != null">ep_heating_fee = #{epHeatingFee},</if>
            <if test="commercialInsurance != null">commercial_insurance = #{commercialInsurance},</if>
            <if test="otherBenefits != null">other_benefits = #{otherBenefits},</if>
            <if test="serviceFee != null">service_fee = #{serviceFee},</if>
            <if test="businessTax != null">business_tax = #{businessTax},</if>
            <if test="deposit != null">deposit = #{deposit},</if>
            <if test="employerLiability != null">employer_liability = #{employerLiability},</if>
            <if test="officeSeat != null">office_seat = #{officeSeat},</if>
            <if test="others != null">others = #{others},</if>
            <if test="serviceFeeTax != null ">service_fee_tax = #{serviceFeeTax},</if>
            <if test="valueAddedTax != null">value_added_tax = #{valueAddedTax},</if>
            <if test="totalCost != null">total_cost = #{totalCost},</if>
            <if test="taxFreeItem != null">tax_free_item = #{taxFreeItem},</if>
            <if test="remarks != null">remarks = #{remarks},</if>
            <if test="groupIds != null and groupIds !=''">group_ids = #{groupIds},</if>
            <if test="payrollSource !=null and payrollSource !=''">payroll_source=#{payrollSource},</if>
            <if test="updateBy != null and updateBy != ''">update_by = #{updateBy},</if>
            update_time = sysdate()
        </trim>
        where id_no = #{idNo} and duration = #{duration}
    </update>


    <update id="updateVendorPsPayroll" parameterType="PsPayroll">
        update vendor_ps_payroll
        <trim prefix="SET" suffixOverrides=",">
            <if test="department != null">department = #{department},</if>
            <if test="duration != null">duration = #{duration},</if>
            <if test="idNo != null">id_no = #{idNo},</if>
            <if test="name != null">name = #{name},</if>
            <if test="netIncome != null">net_income = #{netIncome},</if>
            <if test="expense != null">expense = #{expense},</if>
            <if test="foreignerAllowance != null">foreigner_allowance = #{foreignerAllowance},</if>
            <if test="ipPension != null">ip_pension = #{ipPension},</if>
            <if test="ipMedical != null">ip_medical = #{ipMedical},</if>
            <if test="ipUnemployment != null">ip_unemployment = #{ipUnemployment},</if>
            <if test="ipHousingFund != null">ip_housing_fund = #{ipHousingFund},</if>
            <if test="ipAnnuity != null">ip_annuity = #{ipAnnuity},</if>
            <if test="ipUnionFee != null">ip_union_fee = #{ipUnionFee},</if>
            <if test="IIT != null">IIT = #{IIT},</if>
            <if test="balanceCharge != null">balance_charge = #{balanceCharge},</if>
            <if test="epPension != null">ep_pension = #{epPension},</if>
            <if test="epMedical != null">ep_medical = #{epMedical},</if>
            <if test="epUnemployment != null">ep_unemployment = #{epUnemployment},</if>
            <if test="maternity != null">maternity = #{maternity},</if>
            <if test="workRelatedInjury != null">work_related_Injury = #{workRelatedInjury},</if>
            <if test="disability != null">disability = #{disability},</if>
            <if test="epHousingFund != null">ep_housing_fund = #{epHousingFund},</if>
            <if test="epAnnuity != null">ep_annuity = #{epAnnuity},</if>
            <if test="epUnionFee != null">ep_union_fee = #{epUnionFee},</if>
            <if test="epHeatingFee != null">ep_heating_fee = #{epHeatingFee},</if>
            <if test="commercialInsurance != null">commercial_insurance = #{commercialInsurance},</if>
            <if test="otherBenefits != null">other_benefits = #{otherBenefits},</if>
            <if test="serviceFee != null">service_fee = #{serviceFee},</if>
            <if test="businessTax != null">business_tax = #{businessTax},</if>
            <if test="deposit != null">deposit = #{deposit},</if>
            <if test="employerLiability != null">employer_liability = #{employerLiability},</if>
            <if test="officeSeat != null">office_seat = #{officeSeat},</if>
            <if test="others != null">others = #{others},</if>
            <if test="serviceFeeTax != null ">service_fee_tax = #{serviceFeeTax},</if>
            <if test="valueAddedTax != null">value_added_tax = #{valueAddedTax},</if>
            <if test="totalCost != null">total_cost = #{totalCost},</if>
            <if test="taxFreeItem != null">tax_free_item = #{taxFreeItem},</if>
            <if test="remarks != null">remarks = #{remarks},</if>
            <if test="groupIds != null and groupIds !=''">group_ids = #{groupIds},</if>
            <if test="payrollSource !=null and payrollSource !=''">payroll_source=#{payrollSource},</if>
            <if test="updateBy != null and updateBy != ''">update_by = #{updateBy},</if>
            update_time = sysdate()
        </trim>
        where id_no = #{idNo} and duration = #{duration}
    </update>

    <select id="selectPsPayslipList" parameterType="PsPayslip" resultMap="PsPayslipResult">
        <include refid="selectPsPayslipVo"/>
        <where>
            <if test="department != null  and department != ''">and department = #{department}</if>
            <if test="duration != null  and duration != ''">and duration = #{duration}</if>
            <if test="idNo != null  and idNo != ''">and id_no = #{idNo}</if>
            <if test="name != null  and name != ''">and name like concat('%', #{name}, '%')</if>
            <if test="basicSalary != null ">and basic_salary = #{basicSalary}</if>
            <if test="normalBonus != null ">and normal_bonus = #{normalBonus}</if>
            <if test="annualBonus13thSalary != null ">and annual_bonus_13th_salary = #{annualBonus13thSalary}</if>
            <if test="allowanceSubsidy != null ">and allowance_subsidy = #{allowanceSubsidy}</if>
            <if test="transportAllowance != null ">and transport_allowance = #{transportAllowance}</if>
            <if test="communicationAllowance != null ">and communication_allowance = #{communicationAllowance}</if>
            <if test="mealAllowance != null ">and meal_allowance = #{mealAllowance}</if>
            <if test="birthdayGift != null ">and birthday_gift = #{birthdayGift}</if>
            <if test="otherAllowance != null ">and other_allowance = #{otherAllowance}</if>
            <if test="otPayment != null ">and OT_payment = #{otPayment}</if>
            <if test="affordTax != null ">and afford_tax = #{affordTax}</if>
            <if test="socialBenefitsBasis != null ">and social_benefits_basis = #{socialBenefitsBasis}</if>
            <if test="housingFundBasis != null ">and housing_fund_basis = #{housingFundBasis}</if>
            <if test="pension != null ">and pension = #{pension}</if>
            <if test="medical != null ">and medical = #{medical}</if>
            <if test="unemployment != null ">and unemployment = #{unemployment}</if>
            <if test="housingFund != null ">and housing_fund = #{housingFund}</if>
            <if test="absence != null ">and absence = #{absence}</if>
            <if test="affairLeave != null ">and affair_leave = #{affairLeave}</if>
            <if test="absenteeism != null ">and absenteeism = #{absenteeism}</if>
            <if test="sickLeave != null ">and sick_leave = #{sickLeave}</if>
            <if test="annuity != null ">and annuity = #{annuity}</if>
            <if test="unionFee != null ">and union_fee = #{unionFee}</if>
            <if test="other != null ">and other = #{other}</if>
            <if test="IIT != null ">and IIT = #{IIT}</if>
            <if test="balanceCharge != null ">and balance_charge = #{balanceCharge}</if>
            <if test="expense != null ">and expense = #{expense}</if>
            <if test="foreignersSubsistence != null ">and foreigners_subsistence = #{foreignersSubsistence}</if>
            <if test="netIncome != null ">and net_income = #{netIncome}</if>
            <if test="kfFlag != null ">and kf_flag = #{kfFlag}</if>
            <if test="czFlag != null and czFlag != ''">and cz_flag = #{czFlag}</if>
            <if test="params.beginTime != null and params.beginTime != ''"><!--  -->
                AND duration &gt;= #{params.beginTime}
            </if>
            <if test="params.endTime != null and params.endTime != ''"><!--  -->
                AND duration &lt;= #{params.endTime}
            </if>
        </where>
        order by duration desc,id_no
    </select>

    <select id="selectPsPayslip" parameterType="PsPayslip" resultMap="PsPayslipResult">
        <include refid="selectPsPayslipVo"/>
        <where>
            <if test="department != null  and department != ''">and department = #{department}</if>
            <if test="duration != null  and duration != ''">and duration = #{duration}</if>
            <if test="idNo != null  and idNo != ''">and id_no = #{idNo}</if>
            <if test="name != null  and name != ''">and name like concat('%', #{name}, '%')</if>
            <if test="basicSalary != null ">and basic_salary = #{basicSalary}</if>
            <if test="normalBonus != null ">and normal_bonus = #{normalBonus}</if>
            <if test="annualBonus13thSalary != null ">and annual_bonus_13th_salary = #{annualBonus13thSalary}</if>
            <if test="allowanceSubsidy != null ">and allowance_subsidy = #{allowanceSubsidy}</if>
            <if test="transportAllowance != null ">and transport_allowance = #{transportAllowance}</if>
            <if test="communicationAllowance != null ">and communication_allowance = #{communicationAllowance}</if>
            <if test="mealAllowance != null ">and meal_allowance = #{mealAllowance}</if>
            <if test="birthdayGift != null ">and birthday_gift = #{birthdayGift}</if>
            <if test="otherAllowance != null ">and other_allowance = #{otherAllowance}</if>
            <if test="otPayment != null ">and OT_payment = #{otPayment}</if>
            <if test="affordTax != null ">and afford_tax = #{affordTax}</if>
            <if test="socialBenefitsBasis != null ">and social_benefits_basis = #{socialBenefitsBasis}</if>
            <if test="housingFundBasis != null ">and housing_fund_basis = #{housingFundBasis}</if>
            <if test="pension != null ">and pension = #{pension}</if>
            <if test="medical != null ">and medical = #{medical}</if>
            <if test="unemployment != null ">and unemployment = #{unemployment}</if>
            <if test="housingFund != null ">and housing_fund = #{housingFund}</if>
            <if test="absence != null ">and absence = #{absence}</if>
            <if test="affairLeave != null ">and affair_leave = #{affairLeave}</if>
            <if test="absenteeism != null ">and absenteeism = #{absenteeism}</if>
            <if test="sickLeave != null ">and sick_leave = #{sickLeave}</if>
            <if test="annuity != null ">and annuity = #{annuity}</if>
            <if test="unionFee != null ">and union_fee = #{unionFee}</if>
            <if test="other != null ">and other = #{other}</if>
            <if test="IIT != null ">and IIT = #{IIT}</if>
            <if test="balanceCharge != null ">and balance_charge = #{balanceCharge}</if>
            <if test="expense != null ">and expense = #{expense}</if>
            <if test="foreignersSubsistence != null ">and foreigners_subsistence = #{foreignersSubsistence}</if>
            <if test="netIncome != null ">and net_income = #{netIncome}</if>
            <if test="kfFlag != null ">and kf_flag = #{kfFlag}</if>
            <if test="czFlag != null and czFlag != ''">and cz_flag = #{czFlag}</if>
            <if test="params.beginTime != null and params.beginTime != ''"><!--  -->
                AND duration &gt;= #{params.beginTime}
            </if>
            <if test="params.endTime != null and params.endTime != ''"><!--  -->
                AND duration &lt;= #{params.endTime}
            </if>
        </where>
        order by duration desc,id_no
    </select>

    <insert id="insertPsPayslip" parameterType="PsPayslip" useGeneratedKeys="true" keyProperty="id">
        insert into ps_payslip
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="department != null">department,</if>
            <if test="duration != null">duration,</if>
            <if test="idNo != null">id_no,</if>
            <if test="name != null">name,</if>
            <if test="basicSalary != null">basic_salary,</if>
            <if test="normalBonus != null">normal_bonus,</if>
            <if test="annualBonus13thSalary != null">annual_bonus_13th_salary,</if>
            <if test="allowanceSubsidy != null">allowance_subsidy,</if>
            <if test="transportAllowance != null">transport_allowance,</if>
            <if test="communicationAllowance != null">communication_allowance,</if>
            <if test="mealAllowance != null">meal_allowance,</if>
            <if test="birthdayGift != null">birthday_gift,</if>
            <if test="otherAllowance != null">other_allowance,</if>
            <if test="otPayment != null">OT_payment,</if>
            <if test="affordTax != null">afford_tax,</if>
            <if test="socialBenefitsBasis != null">social_benefits_basis,</if>
            <if test="housingFundBasis != null">housing_fund_basis,</if>
            <if test="pension != null">pension,</if>
            <if test="medical != null">medical,</if>
            <if test="unemployment != null">unemployment,</if>
            <if test="housingFund != null">housing_fund,</if>
            <if test="absence != null">absence,</if>
            <if test="affairLeave != null">affair_leave,</if>
            <if test="absenteeism != null">absenteeism,</if>
            <if test="sickLeave != null">sick_leave,</if>
            <if test="annuity != null">annuity,</if>
            <if test="unionFee != null">union_fee,</if>
            <if test="other != null">other,</if>
            <if test="IIT != null">IIT,</if>
            <if test="balanceCharge != null">balance_charge,</if>
            <if test="expense != null">expense,</if>
            <if test="foreignersSubsistence != null">foreigners_subsistence,</if>
            <if test="netIncome != null">net_income,</if>
            <if test="pretaxAdjustment != null">pre_tax_adjustment,</if>
            <if test="shareIncentives != null">share_incentives,</if>
            <if test="compensation != null">compensation,</if>
            <if test="afterTaxAdjustment != null">after_tax_adjustment,</if>
            <if test="kfFlag != null">kf_flag,</if>
            <if test="czFlag != null">cz_flag,</if>
            <if test="groupIds != null and groupIds !=''">group_ids,</if>
            <if test="createBy != null and createBy != ''">create_by,</if>
            <if test="org !=null and org != ''">org,</if>
            create_time
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="department != null">#{department},</if>
            <if test="duration != null">#{duration},</if>
            <if test="idNo != null">#{idNo},</if>
            <if test="name != null">#{name},</if>
            <if test="basicSalary != null">#{basicSalary},</if>
            <if test="normalBonus != null">#{normalBonus},</if>
            <if test="annualBonus13thSalary != null">#{annualBonus13thSalary},</if>
            <if test="allowanceSubsidy != null">#{allowanceSubsidy},</if>
            <if test="transportAllowance != null">#{transportAllowance},</if>
            <if test="communicationAllowance != null">#{communicationAllowance},</if>
            <if test="mealAllowance != null">#{mealAllowance},</if>
            <if test="birthdayGift != null">#{birthdayGift},</if>
            <if test="otherAllowance != null">#{otherAllowance},</if>
            <if test="otPayment != null">#{otPayment},</if>
            <if test="affordTax != null">#{affordTax},</if>
            <if test="socialBenefitsBasis != null">#{socialBenefitsBasis},</if>
            <if test="housingFundBasis != null">#{housingFundBasis},</if>
            <if test="pension != null">#{pension},</if>
            <if test="medical != null">#{medical},</if>
            <if test="unemployment != null">#{unemployment},</if>
            <if test="housingFund != null">#{housingFund},</if>
            <if test="absence != null">#{absence},</if>
            <if test="affairLeave != null">#{affairLeave},</if>
            <if test="absenteeism != null">#{absenteeism},</if>
            <if test="sickLeave != null">#{sickLeave},</if>
            <if test="annuity != null">#{annuity},</if>
            <if test="unionFee != null">#{unionFee},</if>
            <if test="other != null">#{other},</if>
            <if test="IIT != null">#{IIT},</if>
            <if test="balanceCharge != null">#{balanceCharge},</if>
            <if test="expense != null">#{expense},</if>
            <if test="foreignersSubsistence != null">#{foreignersSubsistence},</if>
            <if test="netIncome != null">#{netIncome},</if>
            <if test="pretaxAdjustment != null">#{pretaxAdjustment},</if>
            <if test="shareIncentives != null">#{shareIncentives},</if>
            <if test="compensation != null">#{compensation},</if>
            <if test="afterTaxAdjustment != null">#{afterTaxAdjustment},</if>
            <if test="kfFlag != null">#{kfFlag},</if>
            <if test="czFlag != null">#{czFlag},</if>
            <if test="groupIds != null and groupIds !=''">#{groupIds},</if>
            <if test="createBy != null and createBy != ''">#{createBy},</if>
            <if test="org !=null and org != ''">#{org},</if>
            sysdate()
        </trim>
    </insert>

    <update id="updatePsPayslip" parameterType="PsPayslip">
        update ps_payslip
        <trim prefix="SET" suffixOverrides=",">
            <if test="department != null">department = #{department},</if>
            <if test="duration != null">duration = #{duration},</if>
            <if test="idNo != null">id_no = #{idNo},</if>
            <if test="name != null">name = #{name},</if>
            <if test="basicSalary != null">basic_salary = #{basicSalary},</if>
            <if test="normalBonus != null">normal_bonus = #{normalBonus},</if>
            <if test="annualBonus13thSalary != null">annual_bonus_13th_salary = #{annualBonus13thSalary},</if>
            <if test="allowanceSubsidy != null">allowance_subsidy = #{allowanceSubsidy},</if>
            <if test="transportAllowance != null ">transport_allowance = #{transportAllowance}</if>
            <if test="communicationAllowance != null ">communication_allowance = #{communicationAllowance}</if>
            <if test="mealAllowance != null ">meal_allowance = #{mealAllowance}</if>
            <if test="birthdayGift != null ">birthday_gift = #{birthdayGift}</if>
            <if test="otherAllowance != null ">other_allowance = #{otherAllowance}</if>
            <if test="otPayment != null">OT_payment = #{otPayment},</if>
            <if test="affordTax != null">afford_tax = #{affordTax},</if>
            <if test="socialBenefitsBasis != null">social_benefits_basis = #{socialBenefitsBasis},</if>
            <if test="housingFundBasis != null">housing_fund_basis = #{housingFundBasis},</if>
            <if test="pension != null">pension = #{pension},</if>
            <if test="medical != null">medical = #{medical},</if>
            <if test="unemployment != null">unemployment = #{unemployment},</if>
            <if test="housingFund != null">housing_fund = #{housingFund},</if>
            <if test="absence != null">absence = #{absence},</if>
            <if test="affairLeave != null">affair_leave = #{affairLeave},</if>
            <if test="absenteeism != null">absenteeism = #{absenteeism},</if>
            <if test="sickLeave != null">sick_leave = #{sickLeave},</if>
            <if test="annuity != null">annuity = #{annuity},</if>
            <if test="unionFee != null">union_fee = #{unionFee},</if>
            <if test="other != null">other = #{other},</if>
            <if test="IIT != null">IIT = #{IIT},</if>
            <if test="balanceCharge != null">balance_charge = #{balanceCharge},</if>
            <if test="expense != null">expense = #{expense},</if>
            <if test="foreignersSubsistence != null">foreigners_subsistence = #{foreignersSubsistence},</if>
            <if test="netIncome != null">net_income = #{netIncome},</if>
            <if test="pretaxAdjustment != null">pre_tax_adjustment = #{pretaxAdjustment},</if>
            <if test="shareIncentives != null">share_incentives = #{shareIncentives},</if>
            <if test="compensation != null">compensation = #{compensation},</if>
            <if test="afterTaxAdjustment != null">after_tax_adjustment = #{afterTaxAdjustment},</if>
            <if test="kfFlag != null">kf_flag = #{kfFlag},</if>
            <if test="czFlag != null">cz_flag = #{czFlag},</if>
            <if test="groupIds != null and groupIds !=''">group_ids = #{groupIds},</if>
            <if test="updateBy != null and updateBy != ''">update_by = #{updateBy},</if>
            <if test="org !=null and org != ''">org=#{org},</if>
            update_time = sysdate()
        </trim>
        where id_no = #{idNo} and duration = #{duration}
    </update>

    <select id="selectPsCoverInfoList" parameterType="PsCoverInfo" resultMap="PsCoverInfoResult">
        select id, duration, er_no, er_name, currency, exchange_rate, group_ids, del_flag, create_by, create_time, update_by, update_time from ps_cover_info
        <where>
            <if test="duration != null  and duration != ''"> and duration = #{duration}</if>
            <if test="erNo != null  and erNo != ''"> and er_no = #{erNo}</if>
            <if test="erName != null  and erName != ''"> and er_name like concat('%', #{erName}, '%')</if>
            <if test="currency != null  and currency != ''"> and currency = #{currency}</if>
            <if test="exchangeRate != null "> and exchange_rate = #{exchangeRate}</if>
        </where>
    </select>

    <insert id="insertPsCoverInfo" parameterType="PsCoverInfo" useGeneratedKeys="true" keyProperty="id">
        insert into ps_cover_info
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="duration != null">duration,</if>
            <if test="erNo != null">er_no,</if>
            <if test="erName != null">er_name,</if>
            <if test="currency != null">currency,</if>
            <if test="exchangeRate != null">exchange_rate,</if>
            <if test="groupIds != null">group_ids,</if>
            <if test="delFlag != null">del_flag,</if>
            <if test="createBy != null">create_by,</if>
            <if test="createTime != null">create_time,</if>
            <if test="updateBy != null">update_by,</if>
            <if test="updateTime != null">update_time,</if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="duration != null">#{duration},</if>
            <if test="erNo != null">#{erNo},</if>
            <if test="erName != null">#{erName},</if>
            <if test="currency != null">#{currency},</if>
            <if test="exchangeRate != null">#{exchangeRate},</if>
            <if test="groupIds != null">#{groupIds},</if>
            <if test="delFlag != null">#{delFlag},</if>
            <if test="createBy != null">#{createBy},</if>
            <if test="createTime != null">#{createTime},</if>
            <if test="updateBy != null">#{updateBy},</if>
            <if test="updateTime != null">#{updateTime},</if>
        </trim>
    </insert>

    <delete id="deletePsCoverInfoByCondition" parameterType="PsCoverInfo">
        delete from ps_cover_info
        <where>
            <if test="duration != null  and duration != ''"> and duration = #{duration}</if>
            <if test="erNo != null  and erNo != ''"> and er_no = #{erNo}</if>
            <if test="erName != null  and erName != ''"> and er_name like concat('%', #{erName}, '%')</if>
        </where>
    </delete>

</mapper>